(function(e,n){typeof exports=="object"&&typeof module!="undefined"?n(exports,require("@nocobase/client"),require("react/jsx-runtime"),require("@ant-design/icons"),require("@nocobase/plugin-workflow/client"),require("react-i18next"),require("@nocobase/utils/client")):typeof define=="function"&&define.amd?define(["exports","@nocobase/client","react/jsx-runtime","@ant-design/icons","@nocobase/plugin-workflow/client","react-i18next","@nocobase/utils/client"],n):(e=typeof globalThis!="undefined"?globalThis:e||self,n(e["@ashley/plugin-workflow-end-process-and-redirect"]={},e["@nocobase/client"],e.jsxRuntime,e["@ant-design/icons"],e["@nocobase/plugin-workflow"],e["react-i18next"],e["@nocobase/utils"]))})(this,function(e,n,t,f,c,w,u){"use strict";var b=Object.defineProperty;var y=(e,n,t)=>n in e?b(e,n,{enumerable:!0,configurable:!0,writable:!0,value:t}):e[n]=t;var o=(e,n,t)=>(y(e,typeof n!="symbol"?n+"":n,t),t);var p=(e,n,t)=>new Promise((f,c)=>{var w=r=>{try{i(t.next(r))}catch(l){c(l)}},u=r=>{try{i(t.throw(r))}catch(l){c(l)}},i=r=>r.done?f(r.value):Promise.resolve(r.value).then(w,u);i((t=t.apply(e,n)).next())});const i="@ashley/plugin-workflow-end-process-and-redirect";class r extends c.Instruction{constructor(){super(...arguments);o(this,"title",`{{t("End Process And Redirect", { ns: "${i}" })}}`);o(this,"type","end-process-and-redirect");o(this,"group","extended");o(this,"description",`{{t("End this process immediately, and redirect to specific URL.", { ns: "${i}" })}}`);o(this,"icon",t.jsx(f.StopOutlined,{}));o(this,"fieldset",{url:{type:"string",required:!0,title:`{{t("URL", { ns: "${i}" })}}`,"x-decorator":"FormItem","x-decorator-props":{},"x-component":"WorkflowVariableTextArea","x-component-props":{placeholder:""}}});o(this,"components",{WorkflowVariableTextArea:c.WorkflowVariableTextArea})}useVariables({key:s,title:a},{types:A,fieldNames:k=c.defaultFieldNames}){return{[k.value]:s,[k.label]:a}}isAvailable({engine:s,workflow:a}){return s.isWorkflowSync(a)}}const l="bodyWorkflow";class x extends n.Plugin{afterAdd(){return p(this,null,function*(){this.app.apiClient.axios.interceptors.response.use(d=>{var a;const s=(a=d.data)==null?void 0:a[l];return s&&(u.DEVICE_TYPE==="pc"?window.location.href=s:u.callFlutter("jump",s)),d},d=>{throw d})})}beforeLoad(){return p(this,null,function*(){})}load(){return p(this,null,function*(){this.app.pm.get("workflow").registerInstruction("end-process-and-redirect",r)})}}e.PluginWorkflowEndProcessAndRedirectClient=x,e.default=x,Object.defineProperties(e,{__esModule:{value:!0},[Symbol.toStringTag]:{value:"Module"}})});
