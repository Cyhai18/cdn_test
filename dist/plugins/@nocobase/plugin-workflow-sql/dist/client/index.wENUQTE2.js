(function(e,o){typeof exports=="object"&&typeof module!="undefined"?o(exports,require("@nocobase/client"),require("react/jsx-runtime"),require("@ant-design/icons"),require("@nocobase/plugin-workflow/client"),require("react-i18next")):typeof define=="function"&&define.amd?define(["exports","@nocobase/client","react/jsx-runtime","@ant-design/icons","@nocobase/plugin-workflow/client","react-i18next"],o):(e=typeof globalThis!="undefined"?globalThis:e||self,o(e["@nocobase/plugin-workflow-sql"]={},e["@nocobase/client"],e.jsxRuntime,e["@ant-design/icons"],e["@nocobase/plugin-workflow"],e["react-i18next"]))})(this,function(e,o,t,d,s,p){"use strict";var m=Object.defineProperty;var b=(e,o,t)=>o in e?m(e,o,{enumerable:!0,configurable:!0,writable:!0,value:t}):e[o]=t;var r=(e,o,t)=>(b(e,typeof o!="symbol"?o+"":o,t),t);var u=(e,o,t)=>new Promise((d,s)=>{var p=n=>{try{a(t.next(n))}catch(c){s(c)}},i=n=>{try{a(t.throw(n))}catch(c){s(c)}},a=n=>n.done?d(n.value):Promise.resolve(n.value).then(p,i);a((t=t.apply(e,o)).next())});const i="@nocobase/plugin-workflow-sql";class a extends s.Instruction{constructor(){super(...arguments);r(this,"title",`{{t("SQL action", { ns: "${i}" })}}`);r(this,"type","sql");r(this,"group","collection");r(this,"description",`{{t("Execute a SQL statement in database.", { ns: "${i}" })}}`);r(this,"icon",t.jsx(d.ConsoleSqlOutlined,{style:{}}));r(this,"fieldset",{dataSource:{type:"string",required:!0,title:'{{t("Data source")}}',description:`{{t("Select a data source to execute SQL.", { ns: "${i}" })}}`,"x-decorator":"FormItem","x-component":"DataSourceSelect","x-component-props":{className:"auto-width",filter(l){return l.options.isDBInstance||l.key===o.DEFAULT_DATA_SOURCE_KEY}},default:"main"},sql:{type:"string",required:!0,title:"SQL",description:"{{sqlDescription()}}","x-decorator":"FormItem","x-component":"WorkflowVariableRawTextArea","x-component-props":{rows:20,className:o.css`
          font-size: 80%;
          font-family: Consolas, Monaco, 'Andale Mono', 'Ubuntu Mono', monospace;
        `}}});r(this,"scope",{sqlDescription(){return t.jsxs(p.Trans,{ns:i,children:["SQL query result could be used through ",t.jsx("a",{href:"https://docs-cn.nocobase.com/handbook/workflow-json-query",target:"_blank",rel:"noreferrer",children:"JSON query node"})," (Commercial plugin)."]})}});r(this,"components",{WorkflowVariableRawTextArea:s.WorkflowVariableRawTextArea})}useVariables({key:l,title:x},{types:q,fieldNames:f=s.defaultFieldNames}){return{[f.value]:l,[f.label]:x}}}class n extends o.Plugin{afterAdd(){return u(this,null,function*(){})}beforeLoad(){return u(this,null,function*(){})}load(){return u(this,null,function*(){this.app.pm.get("workflow").registerInstruction("sql",a)})}}e.default=n,Object.defineProperties(e,{__esModule:{value:!0},[Symbol.toStringTag]:{value:"Module"}})});
