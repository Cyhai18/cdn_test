(function(e,t){typeof exports=="object"&&typeof module!="undefined"?t(exports,require("@nocobase/client"),require("react/jsx-runtime"),require("antd"),require("@formily/shared"),require("react-i18next"),require("@formily/antd-v5"),require("@formily/react"),require("react"),require("@nocobase/utils/client")):typeof define=="function"&&define.amd?define(["exports","@nocobase/client","react/jsx-runtime","antd","@formily/shared","react-i18next","@formily/antd-v5","@formily/react","react","@nocobase/utils/client"],t):(e=typeof globalThis!="undefined"?globalThis:e||self,t(e["@nocobase/plugin-verification"]={},e["@nocobase/client"],e.jsxRuntime,e.antd,e["@formily/shared"],e["react-i18next"],e["@formily/antd-v5"],e["@formily/react"],e.react,e["@nocobase/utils"]))})(this,function(e,t,o,a,s,u,m,r,i,p){"use strict";var P=Object.defineProperty,$=Object.defineProperties;var q=Object.getOwnPropertyDescriptors;var f=Object.getOwnPropertySymbols;var j=Object.prototype.hasOwnProperty,V=Object.prototype.propertyIsEnumerable;var v=(e,t,o)=>t in e?P(e,t,{enumerable:!0,configurable:!0,writable:!0,value:o}):e[t]=o,F=(e,t)=>{for(var o in t||(t={}))j.call(t,o)&&v(e,o,t[o]);if(f)for(var o of f(t))V.call(t,o)&&v(e,o,t[o]);return e},I=(e,t)=>$(e,q(t));var S=(e,t,o)=>new Promise((a,s)=>{var u=i=>{try{r(o.next(i))}catch(p){s(p)}},m=i=>{try{r(o.throw(i))}catch(p){s(p)}},r=i=>i.done?a(i.value):Promise.resolve(i.value).then(u,m);r((o=o.apply(e,t)).next())});const n="verification",x={name:"verifications_providers",fields:[{type:"string",name:"id",interface:"input",uiSchema:{title:'{{t("ID")}}',type:"string","x-component":"Input",required:!0}},{type:"string",name:"title",interface:"input",uiSchema:{title:'{{t("Title")}}',type:"string","x-component":"Input",required:!0}},{type:"string",name:"type",interface:"select",uiSchema:{title:`{{t("Provider type", { ns: "${n}" })}}`,type:"string","x-component":"Select",required:!0,enum:[{label:`{{t("Aliyun SMS", { ns: "${n}" })}}`,value:"sms-aliyun"},{label:`{{t("Tencent SMS", { ns: "${n}" })}}`,value:"sms-tencent"}]}},{type:"radio",name:"default",interface:"checkbox",uiSchema:{title:'{{t("Default")}}',type:"boolean","x-component":"Checkbox"}}]},A={type:"void",name:"providers","x-decorator":"ResourceActionProvider","x-decorator-props":{collection:x,resourceName:"verifications_providers",request:{resource:"verifications_providers",action:"list",params:{pageSize:50,sort:["-default","id"],appends:[]}}},"x-component":"CollectionProvider_deprecated","x-component-props":{collection:x},properties:{actions:{type:"void","x-component":"ActionBar","x-component-props":{style:{marginBottom:16}},properties:{delete:{type:"void",title:'{{t("Delete")}}',"x-component":"Action","x-component-props":{icon:"DeleteOutlined",useAction:"{{ cm.useBulkDestroyAction }}",confirm:{title:"{{t('Delete')}}",content:"{{t('Are you sure you want to delete it?')}}"}}},create:{type:"void",title:'{{t("Add new")}}',"x-component":"Action","x-component-props":{type:"primary",icon:"PlusOutlined"},properties:{drawer:{type:"void","x-component":"Action.Drawer","x-decorator":"Form","x-decorator-props":{useValues(d){const c=t.useActionContext();return t.useRequest(()=>Promise.resolve({data:{name:`s_${s.uid()}`}}),I(F({},d),{refreshDeps:[c.visible]}))}},title:'{{t("Add new")}}',properties:{id:{"x-component":"CollectionField","x-decorator":"FormItem",description:'{{t("Identifier for program usage. Support letters, numbers and underscores, must start with an letter.")}}'},title:{"x-component":"CollectionField","x-decorator":"FormItem"},type:{"x-component":"CollectionField","x-decorator":"FormItem"},options:{type:"object","x-component":"ProviderOptions"},default:{"x-component":"CollectionField","x-decorator":"FormItem"},footer:{type:"void","x-component":"Action.Drawer.Footer",properties:{cancel:{title:'{{t("Cancel")}}',"x-component":"Action","x-component-props":{useAction:"{{ cm.useCancelAction }}"}},submit:{title:'{{t("Submit")}}',"x-component":"Action","x-component-props":{type:"primary",useAction:"{{ cm.useCreateAction }}"}}}}}}}}}},table:{type:"void","x-uid":"input","x-component":"Table.Void","x-component-props":{rowKey:"id",rowSelection:{type:"checkbox"},useDataSource:"{{ cm.useDataSourceFromRAC }}"},properties:{id:{type:"void","x-decorator":"Table.Column.Decorator","x-component":"Table.Column",properties:{id:{type:"string","x-component":"CollectionField","x-read-pretty":!0}}},title:{type:"void","x-decorator":"Table.Column.Decorator","x-component":"Table.Column",properties:{title:{type:"string","x-component":"CollectionField","x-read-pretty":!0}}},type:{type:"void","x-decorator":"Table.Column.Decorator","x-component":"Table.Column",properties:{type:{type:"string","x-component":"CollectionField","x-read-pretty":!0}}},default:{type:"void","x-decorator":"Table.Column.Decorator","x-component":"Table.Column",properties:{default:{type:"boolean","x-component":"CollectionField","x-read-pretty":!0}}},actions:{type:"void",title:'{{t("Actions")}}',"x-component":"Table.Column",properties:{actions:{type:"void","x-component":"Space","x-component-props":{split:"|"},properties:{update:{type:"void",title:'{{t("Edit")}}',"x-component":"Action.Link","x-component-props":{type:"primary"},properties:{drawer:{type:"void","x-component":"Action.Drawer","x-decorator":"Form","x-decorator-props":{useValues:"{{ cm.useValuesFromRecord }}"},title:'{{t("Edit")}}',properties:{id:{"x-component":"CollectionField","x-decorator":"FormItem"},title:{"x-component":"CollectionField","x-decorator":"FormItem"},type:{"x-component":"CollectionField","x-decorator":"FormItem","x-disabled":!0},options:{type:"object","x-component":"ProviderOptions"},default:{"x-component":"CollectionField","x-decorator":"FormItem"},footer:{type:"void","x-component":"Action.Drawer.Footer",properties:{cancel:{title:'{{t("Cancel")}}',"x-component":"Action","x-component-props":{useAction:"{{ cm.useCancelAction }}"}},submit:{title:'{{t("Submit")}}',"x-component":"Action","x-component-props":{type:"primary",useAction:"{{ cm.useUpdateAction }}"}}}}}}}},delete:{type:"void",title:'{{ t("Delete") }}',"x-component":"Action.Link","x-component-props":{confirm:{title:"{{t('Delete record')}}",content:"{{t('Are you sure you want to delete it?')}}"},useAction:"{{cm.useDestroyAction}}"}}}}}}}}}},C={type:"object",properties:{accessKeyId:{title:`{{t("Access Key ID", { ns: "${n}" })}}`,type:"string","x-decorator":"FormItem","x-component":"Input"},accessKeySecret:{title:`{{t("Access Key Secret", { ns: "${n}" })}}`,type:"string","x-decorator":"FormItem","x-component":"Password"},endpoint:{title:`{{t("Endpoint", { ns: "${n}" })}}`,type:"string","x-decorator":"FormItem","x-component":"Input"},sign:{title:`{{t("Sign", { ns: "${n}" })}}`,type:"string","x-decorator":"FormItem","x-component":"Input"},template:{title:`{{t("Template code", { ns: "${n}" })}}`,type:"string","x-decorator":"FormItem","x-component":"Input"}}},g={type:"object",properties:{secretId:{title:`{{t("Secret Id", { ns: "${n}" })}}`,type:"string","x-decorator":"FormItem","x-component":"Input"},secretKey:{title:`{{t("Secret Key", { ns: "${n}" })}}`,type:"string","x-decorator":"FormItem","x-component":"Password"},region:{title:`{{t("Region", { ns: "${n}" })}}`,type:"string","x-decorator":"FormItem","x-component":"Input"},endpoint:{title:`{{t("Endpoint", { ns: "${n}" })}}`,type:"string","x-decorator":"FormItem","x-component":"Input",default:"sms.tencentcloudapi.com"},SignName:{title:`{{t("Sign name", { ns: "${n}" })}}`,type:"string","x-decorator":"FormItem","x-component":"Input"},SmsSdkAppId:{title:`{{t("Sms sdk app id", { ns: "${n}" })}}`,type:"string","x-decorator":"FormItem","x-component":"Input"},TemplateId:{title:`{{t("Template Id", { ns: "${n}" })}}`,type:"string","x-decorator":"FormItem","x-component":"Input"}}},l=new p.Registry;l.register("sms-aliyun",C),l.register("sms-tencent",g);const b=r.observer(d=>{const c=r.useForm(),D=r.useField(),[T,w]=i.useState(new r.Schema({}));return i.useEffect(()=>{c.clearFormGraph("options.*"),w(new r.Schema(l.get(c.values.type)||{}))},[c.values.type]),o.jsx(m.FormLayout,{layout:"vertical",children:o.jsx(r.RecursionField,{basePath:D.address,onlyRenderProperties:!0,schema:T},c.values.type||"sms-aliyun")})},{displayName:"Verification"});function h(){return o.jsx(a.Card,{bordered:!1,children:o.jsx(t.SchemaComponent,{schema:A,components:{ProviderOptions:b}})})}class y extends t.Plugin{load(){return S(this,null,function*(){this.app.pluginSettingsManager.add(n,{icon:"CheckCircleOutlined",title:`{{t("Verification", { ns: "${n}" })}}`,Component:h,aclSnippet:"pm.verification.providers"})})}}e.PluginVerificationClient=y,e.default=y,Object.defineProperties(e,{__esModule:{value:!0},[Symbol.toStringTag]:{value:"Module"}})});
