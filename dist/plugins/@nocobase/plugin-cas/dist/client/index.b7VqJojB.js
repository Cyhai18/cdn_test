(function(e,o){typeof exports=="object"&&typeof module!="undefined"?o(exports,require("@nocobase/client"),require("react/jsx-runtime"),require("react"),require("@ant-design/icons"),require("antd"),require("react-router-dom"),require("@nocobase/sdk"),require("react-i18next"),require("@nocobase/plugin-auth/client")):typeof define=="function"&&define.amd?define(["exports","@nocobase/client","react/jsx-runtime","react","@ant-design/icons","antd","react-router-dom","@nocobase/sdk","react-i18next","@nocobase/plugin-auth/client"],o):(e=typeof globalThis!="undefined"?globalThis:e||self,o(e["@nocobase/plugin-cas"]={},e["@nocobase/client"],e.jsxRuntime,e.react,e["@ant-design/icons"],e.antd,e["react-router-dom"],e["@nocobase/sdk"],e["react-i18next"],e["@nocobase/plugin-auth"]))})(this,function(e,o,t,p,s,r,d,i,n,a){"use strict";var m=(e,o,t)=>new Promise((p,s)=>{var r=n=>{try{i(t.next(n))}catch(a){s(a)}},d=n=>{try{i(t.throw(n))}catch(a){s(a)}},i=n=>n.done?p(n.value):Promise.resolve(n.value).then(r,d);i((t=t.apply(e,o)).next())});const x=c=>{const u=c.authenticator,T=d.useLocation(),l=new URLSearchParams(T.search),j=l.get("redirect"),k=i.getSubAppName()||"main",v=()=>m(this,null,function*(){window.location.replace(`/api/cas:login?authenticator=${u.name}&__appName=${k}&redirect=${j}`)});return p.useEffect(()=>{const A=l.get("authenticator"),g=l.get("error");if(A===u.name&&g){r.message.error(g);return}}),t.jsx(r.Space,{direction:"vertical",style:{display:"flex"},children:t.jsx(r.Button,{shape:"round",block:!0,icon:t.jsx(s.LoginOutlined,{}),onClick:v,children:u.title})})},h="cas";function S(){return n.useTranslation(h)}function y(c){return`{{t('${c}', { ns: '${h}', nsMode: 'fallback' })}}`}const q=()=>{const{t:c}=S();return t.jsx(o.SchemaComponent,{scope:{t:c},components:{Space:r.Space},schema:{type:"object",properties:{autoSignup:{"x-decorator":"FormItem",type:"boolean",title:'{{t("Sign up automatically when the user does not exist")}}',"x-component":"Checkbox"},casUrl:{title:'{{t("CAS URL")}}',"x-component":"Input","x-decorator":"FormItem",required:!0},serviceDomain:{title:'{{t("Service domain")}}',"x-component":"Input","x-decorator":"FormItem","x-decorator-props":{tooltip:y("The domain is usually the address of your server, in local development, you can use the address of your local machine, such as: http://localhost:13000")},required:!0}}}})},b="CAS";class f extends o.Plugin{load(){return m(this,null,function*(){this.app.pm.get(a).registerType(b,{components:{SignInButton:x,AdminSettingsForm:q}})})}}e.SamlPlugin=f,e.default=f,Object.defineProperties(e,{__esModule:{value:!0},[Symbol.toStringTag]:{value:"Module"}})});
