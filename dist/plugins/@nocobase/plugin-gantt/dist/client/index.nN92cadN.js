(function(I,c){typeof exports=="object"&&typeof module!="undefined"?c(exports,require("react/jsx-runtime"),require("@nocobase/client"),require("react"),require("@formily/react"),require("react-i18next"),require("@ant-design/icons"),require("@formily/antd-v5"),require("@formily/shared"),require("@emotion/css"),require("antd"),require("lodash"),require("antd-style"),require("@nocobase/utils/client")):typeof define=="function"&&define.amd?define(["exports","react/jsx-runtime","@nocobase/client","react","@formily/react","react-i18next","@ant-design/icons","@formily/antd-v5","@formily/shared","@emotion/css","antd","lodash","antd-style","@nocobase/utils/client"],c):(I=typeof globalThis!="undefined"?globalThis:I||self,c(I["@nocobase/plugin-gantt"]={},I.jsxRuntime,I["@nocobase/client"],I.react,I["@formily/react"],I["react-i18next"],I["@ant-design/icons"],I["@formily/antd-v5"],I["@formily/shared"],I["@emotion/css"],I.antd,I.lodash,I["antd-style"],I["@nocobase/utils"]))})(this,function(I,c,d,g,F,me,Ke,Pe,se,M,Je,ht,Ee,ze){"use strict";var Ho=Object.defineProperty,Go=Object.defineProperties;var Oo=Object.getOwnPropertyDescriptors;var er=Object.getOwnPropertySymbols;var Xo=Object.prototype.hasOwnProperty,Yo=Object.prototype.propertyIsEnumerable;var tr=(I,c,d)=>c in I?Ho(I,c,{enumerable:!0,configurable:!0,writable:!0,value:d}):I[c]=d,X=(I,c)=>{for(var d in c||(c={}))Xo.call(c,d)&&tr(I,d,c[d]);if(er)for(var d of er(c))Yo.call(c,d)&&tr(I,d,c[d]);return I},we=(I,c)=>Go(I,Oo(c));var ae=(I,c,d)=>new Promise((g,F)=>{var me=se=>{try{Pe(d.next(se))}catch(M){F(M)}},Ke=se=>{try{Pe(d.throw(se))}catch(M){F(M)}},Pe=se=>se.done?g(se.value):Promise.resolve(se.value).then(me,Ke);Pe((d=d.apply(I,c)).next())});const rr=()=>{const{name:e,title:t}=d.useCollection_deprecated(),r=d.useSchemaTemplate();return c.jsx(d.GeneralSchemaDesigner,{schemaSettings:"blockSettings:gantt",template:r,title:t||e})},Ze=g.createContext({});Ze.displayName="GanttBlockContext";const Re=(e=[],t,r=[],o=void 0,n=!1,a,i)=>(e.forEach(s=>{var f,y;const l=a(s),u=parseFloat((s[t.progress]*100).toFixed(2));s.children&&s.children.length?(r.push({start:new Date((f=s[t.start])!=null?f:void 0),end:new Date((y=s[t.end])!=null?y:void 0),name:s[t.title],id:s[i]+"",type:"project",progress:u>100?100:u||0,hideChildren:n,project:o,color:s.color,isDisabled:l}),Re(s.children,t,r,s.id+"",n,a,i)):r.push({start:s[t.start]?new Date(s[t.start]):void 0,end:new Date(s[t.end]||s[t.start]),name:s[t.title],id:s[i]+"",type:t.end?"task":"milestone",progress:u>100?100:u||0,project:o,color:s.color,isDisabled:l})}),r),or=e=>{const{fieldNames:t,timeRange:r,resource:o}=e,n=F.useField(),{service:a}=d.useBlockRequestContext();return c.jsx(Ze.Provider,{value:{field:n,service:a,resource:o,fieldNames:t,timeRange:r},children:e.children})},nr=e=>{const t={filter:e.params.filter,paginate:!1,sort:["id"]},r=d.useCollection_deprecated();return r!=null&&r.tree&&(t.tree=!0),c.jsx("div",{"aria-label":"block-item-gantt",role:"button",children:c.jsx(d.TableBlockProvider,we(X({name:"gantt"},e),{params:t,children:c.jsx(or,X({},e))}))})},J=()=>g.useContext(Ze),ft=()=>{var T;const e=J(),[t,r]=g.useState([]),{getPrimaryKey:o,name:n,template:a,writableView:i}=d.useCollection_deprecated(),{parseAction:s}=d.useACLRoleContext(),l=d.useTableBlockContext(),u=o(),f=b=>{const A=`${n}:update`,p={},x=b==null?void 0:b[u],S=s(A,{schema:p,recordPkValue:x});return a==="view"&&!i||!S},y=b=>{const p=e.field.data.map(x=>x.id===b.id?b:x);r(p),e.field.data=p},V=b=>{var p;const A=Re((p=e.service.data)==null?void 0:p.data,e.fieldNames,[],void 0,b,f,u);r(A),e.field.data=A};return g.useEffect(()=>{var b,A;if(!((b=e==null?void 0:e.service)!=null&&b.loading)){const p=Re((A=e.service.data)==null?void 0:A.data,e.fieldNames,[],void 0,!1,f,u);r(p),e.field.data=p,t.length>0&&l.setExpandFlag(!0)}},[(T=e==null?void 0:e.service)==null?void 0:T.loading]),{fieldNames:e.fieldNames,timeRange:e.timeRange,onExpanderClick:y,expandAndCollapseAll:V,tasks:t}},te=()=>me.useTranslation("gantt"),he=(e="string")=>{var n;const t=d.useCompile(),{fields:r}=d.useCollection_deprecated();return(n=r==null?void 0:r.filter(a=>a.type===e))==null?void 0:n.map(a=>{var i;return{value:a.name,label:t((i=a==null?void 0:a.uiSchema)==null?void 0:i.title)}})},ar=new d.SchemaSettings({name:"GanttBlockSettings",items:[{name:"title",Component:d.SchemaSettingsBlockTitleItem},{name:"titleField",Component:d.SchemaSettingsSelectItem,useComponentProps(){var i;const{t:e}=te(),t=F.useFieldSchema(),r=((i=t==null?void 0:t["x-decorator-props"])==null?void 0:i.fieldNames)||{},{service:o}=J(),n=F.useField(),{dn:a}=d.useDesignable();return{title:e("Title field"),value:r.title,options:he("string"),onChange:s=>{const l=n.decoratorProps.fieldNames||{};l.title=s,n.decoratorProps.params=l,t["x-decorator-props"].params=l,t["x-decorator-props"].fieldNames=l,o.refresh(),a.emit("patch",{schema:{"x-uid":t["x-uid"],"x-decorator-props":n.decoratorProps}}),a.refresh()}}}},{name:"timeScale",Component:d.SchemaSettingsSelectItem,useComponentProps(){var s;const{t:e}=te(),t=F.useFieldSchema(),r=((s=t==null?void 0:t["x-decorator-props"])==null?void 0:s.fieldNames)||{},o=F.useField(),{service:n}=J(),{dn:a}=d.useDesignable(),i=d.useCompile();return{title:e("Time scale"),value:r.range||"day",options:[{label:i('{{t("Hour")}}'),value:"hour",color:"orange"},{label:i('{{t("Quarter of day")}}'),value:"quarterDay",color:"default"},{label:i('{{t("Half of day")}}'),value:"halfDay",color:"blue"},{label:i('{{t("Day")}}'),value:"day",color:"yellow"},{label:i('{{t("Week")}}'),value:"week",color:"pule"},{label:i('{{t("Month")}}'),value:"month",color:"green"},{label:i('{{t("QuarterYear")}}'),value:"quarterYear",color:"red"},{label:i('{{t("Year")}}'),value:"year",color:"green"}],onChange:l=>{const u=o.decoratorProps.fieldNames||{};u.range=l,o.decoratorProps.params=u,t["x-decorator-props"].params=u,t["x-decorator-props"].fieldNames=u,n.refresh(),a.emit("patch",{schema:{"x-uid":t["x-uid"],"x-decorator-props":o.decoratorProps}}),a.refresh()}}}},{name:"startDateField",Component:d.SchemaSettingsSelectItem,useComponentProps(){var i;const{t:e}=te(),t=F.useFieldSchema(),r=((i=t==null?void 0:t["x-decorator-props"])==null?void 0:i.fieldNames)||{},o=F.useField(),{dn:n}=d.useDesignable(),{service:a}=J();return{title:e("Start date field"),value:r.start,options:he("date"),onChange:s=>{const l=o.decoratorProps.fieldNames||{};l.start=s,o.decoratorProps.fieldNames=l,t["x-decorator-props"].fieldNames=l,a.refresh(),n.emit("patch",{schema:{"x-uid":t["x-uid"],"x-decorator-props":o.decoratorProps}}),n.refresh()}}}},{name:"endDateField",Component:d.SchemaSettingsSelectItem,useComponentProps(){var i;const{t:e}=te(),t=F.useFieldSchema(),r=F.useField(),{service:o}=J(),{dn:n}=d.useDesignable(),a=((i=t==null?void 0:t["x-decorator-props"])==null?void 0:i.fieldNames)||{};return{title:e("End date field"),value:a.end,options:he("date"),onChange:s=>{const l=r.decoratorProps.fieldNames||{};l.end=s,r.decoratorProps.fieldNames=l,t["x-decorator-props"].fieldNames=l,o.refresh(),n.emit("patch",{schema:{"x-uid":t["x-uid"],"x-decorator-props":r.decoratorProps}}),n.refresh()}}}},{name:"processField",Component:d.SchemaSettingsSelectItem,useComponentProps(){var i;const{t:e}=te(),t=F.useFieldSchema(),r=((i=t==null?void 0:t["x-decorator-props"])==null?void 0:i.fieldNames)||{},{service:o}=J(),{dn:n}=d.useDesignable(),a=F.useField();return{title:e("Progress field"),value:r.progress,options:he("float"),onChange:s=>{const l=a.decoratorProps.fieldNames||{};l.progress=s,a.decoratorProps.fieldNames=l,t["x-decorator-props"].fieldNames=l,o.refresh(),n.emit("patch",{schema:{"x-uid":t["x-uid"],"x-decorator-props":a.decoratorProps}}),n.refresh()}}}},{name:"dataScope",Component:d.SchemaSettingsDataScope,useComponentProps(){var a,i;const{name:e}=d.useCollection_deprecated(),t=F.useFieldSchema(),{form:r}=d.useFormBlockContext(),o=F.useField(),{dn:n}=d.useDesignable();return{collectionName:e,defaultFilter:((i=(a=t==null?void 0:t["x-decorator-props"])==null?void 0:a.params)==null?void 0:i.filter)||{},form:r,onSubmit:({filter:s})=>{s=d.removeNullCondition(s);const l=o.decoratorProps.params||{};l.filter=s,o.decoratorProps.params=l,t["x-decorator-props"].params=l,n.emit("patch",{schema:{"x-uid":t["x-uid"],"x-decorator-props":t["x-decorator-props"]}})}}}},{name:"divider",type:"divider"},{name:"template",Component:d.SchemaSettingsTemplate,useComponentProps(){const{name:e}=d.useCollection_deprecated();return{componentName:"Gantt",collectionName:e}}},{name:"divider2",type:"divider"},{name:"remove",type:"remove",componentProps:{removeParentsIfNoChildren:!0,breakRemoveOn:{"x-component":"Grid"}}}]}),sr=new d.SchemaSettings({name:"blockSettings:gantt",items:[{name:"title",Component:d.SchemaSettingsBlockTitleItem},{name:"titleField",Component:d.SchemaSettingsSelectItem,useComponentProps(){var i;const{t:e}=te(),t=F.useFieldSchema(),r=((i=t==null?void 0:t["x-decorator-props"])==null?void 0:i.fieldNames)||{},{service:o}=J(),n=F.useField(),{dn:a}=d.useDesignable();return{title:e("Title field"),value:r.title,options:he("string"),onChange:s=>{const l=n.decoratorProps.fieldNames||{};l.title=s,n.decoratorProps.params=l,t["x-decorator-props"].params=l,t["x-decorator-props"].fieldNames=l,o.refresh(),a.emit("patch",{schema:{"x-uid":t["x-uid"],"x-decorator-props":n.decoratorProps}}),a.refresh()}}}},{name:"timeScale",Component:d.SchemaSettingsSelectItem,useComponentProps(){var s;const{t:e}=te(),t=F.useFieldSchema(),r=((s=t==null?void 0:t["x-decorator-props"])==null?void 0:s.fieldNames)||{},o=F.useField(),{service:n}=J(),{dn:a}=d.useDesignable(),i=d.useCompile();return{title:e("Time scale"),value:r.range||"day",options:[{label:i('{{t("Hour")}}'),value:"hour",color:"orange"},{label:i('{{t("Quarter of day")}}'),value:"quarterDay",color:"default"},{label:i('{{t("Half of day")}}'),value:"halfDay",color:"blue"},{label:i('{{t("Day")}}'),value:"day",color:"yellow"},{label:i('{{t("Week")}}'),value:"week",color:"pule"},{label:i('{{t("Month")}}'),value:"month",color:"green"},{label:i('{{t("QuarterYear")}}'),value:"quarterYear",color:"red"},{label:i('{{t("Year")}}'),value:"year",color:"green"}],onChange:l=>{const u=o.decoratorProps.fieldNames||{};u.range=l,o.decoratorProps.params=u,t["x-decorator-props"].params=u,t["x-decorator-props"].fieldNames=u,n.refresh(),a.emit("patch",{schema:{"x-uid":t["x-uid"],"x-decorator-props":o.decoratorProps}}),a.refresh()}}}},{name:"startDateField",Component:d.SchemaSettingsSelectItem,useComponentProps(){var i;const{t:e}=te(),t=F.useFieldSchema(),r=((i=t==null?void 0:t["x-decorator-props"])==null?void 0:i.fieldNames)||{},o=F.useField(),{dn:n}=d.useDesignable(),{service:a}=J();return{title:e("Start date field"),value:r.start,options:he("date"),onChange:s=>{const l=o.decoratorProps.fieldNames||{};l.start=s,o.decoratorProps.fieldNames=l,t["x-decorator-props"].fieldNames=l,a.refresh(),n.emit("patch",{schema:{"x-uid":t["x-uid"],"x-decorator-props":o.decoratorProps}}),n.refresh()}}}},d.setDataLoadingModeSettingsItem,{name:"endDateField",Component:d.SchemaSettingsSelectItem,useComponentProps(){var i;const{t:e}=te(),t=F.useFieldSchema(),r=F.useField(),{service:o}=J(),{dn:n}=d.useDesignable(),a=((i=t==null?void 0:t["x-decorator-props"])==null?void 0:i.fieldNames)||{};return{title:e("End date field"),value:a.end,options:he("date"),onChange:s=>{const l=r.decoratorProps.fieldNames||{};l.end=s,r.decoratorProps.fieldNames=l,t["x-decorator-props"].fieldNames=l,o.refresh(),n.emit("patch",{schema:{"x-uid":t["x-uid"],"x-decorator-props":r.decoratorProps}}),n.refresh()}}}},{name:"processField",Component:d.SchemaSettingsSelectItem,useComponentProps(){var i;const{t:e}=te(),t=F.useFieldSchema(),r=((i=t==null?void 0:t["x-decorator-props"])==null?void 0:i.fieldNames)||{},{service:o}=J(),{dn:n}=d.useDesignable(),a=F.useField();return{title:e("Progress field"),value:r.progress,options:he("float"),onChange:s=>{const l=a.decoratorProps.fieldNames||{};l.progress=s,a.decoratorProps.fieldNames=l,t["x-decorator-props"].fieldNames=l,o.refresh(),n.emit("patch",{schema:{"x-uid":t["x-uid"],"x-decorator-props":a.decoratorProps}}),n.refresh()}}}},{name:"dataScope",Component:d.SchemaSettingsDataScope,useComponentProps(){var a,i;const{name:e}=d.useCollection(),t=F.useFieldSchema(),{form:r}=d.useFormBlockContext(),o=F.useField(),{dn:n}=d.useDesignable();return{collectionName:e,defaultFilter:((i=(a=t==null?void 0:t["x-decorator-props"])==null?void 0:a.params)==null?void 0:i.filter)||{},form:r,onSubmit:({filter:s})=>{s=d.removeNullCondition(s);const l=o.decoratorProps.params||{};l.filter=s,o.decoratorProps.params=l,t["x-decorator-props"].params=l,n.emit("patch",{schema:{"x-uid":t["x-uid"],"x-decorator-props":t["x-decorator-props"]}})}}}},{name:"divider",type:"divider"},{name:"template",Component:d.SchemaSettingsTemplate,useComponentProps(){const{name:e}=d.useCollection();return{componentName:"Gantt",collectionName:e}}},{name:"divider2",type:"divider"},{name:"editTheme",Component:d.SchemaSettingsThemeEditItem,useComponentProps(){const{t:e}=me.useTranslation();return{title:e("Block theme")}}},{name:"divider3",type:"divider"},{name:"remove",type:"remove",componentProps:{removeParentsIfNoChildren:!0,breakRemoveOn:{"x-component":"Grid"}}}]}),gt=new d.CompatibleSchemaInitializer({name:"GanttActionInitializers",title:"{{t('Configure actions')}}",icon:"SettingOutlined",style:{marginLeft:8},items:[{type:"itemGroup",name:"enableActions",title:"{{t('Enable actions')}}",children:[{type:"item",name:"filter",title:"{{t('Filter')}}",Component:"FilterActionInitializer",schema:{"x-align":"left"}},{type:"item",title:"{{t('Add new')}}",name:"addNew",Component:"CreateActionInitializer",schema:{"x-align":"right","x-decorator":"ACLActionProvider","x-acl-action-props":{skipScopeCheck:!0}},useVisible(){const e=d.useCollection_deprecated();return!["view","file","sql"].includes(e.template)||(e==null?void 0:e.writableView)}},{type:"item",title:"{{t('Delete')}}",name:"delete",Component:"BulkDestroyActionInitializer",schema:{"x-align":"right","x-decorator":"ACLActionProvider"},useVisible(){const e=d.useCollection_deprecated();return!["view","sql"].includes(e.template)||(e==null?void 0:e.writableView)}},{type:"item",title:"{{t('Refresh')}}",name:"refresh",Component:"RefreshActionInitializer",schema:{"x-align":"right"}},{name:"toggle",title:"{{t('Expand/Collapse')}}",Component:"ExpandableActionInitializer",schema:{"x-align":"right"},useVisible(){var o;const e=F.useFieldSchema(),t=d.useCollection_deprecated(),{treeTable:r}=((o=e==null?void 0:e.parent)==null?void 0:o["x-decorator-props"])||{};return t.tree&&r}}]},{name:"divider",type:"divider",useVisible(){const e=d.useCollection_deprecated();return!["view","sql"].includes(e.template)||(e==null?void 0:e.writableView)}},{type:"subMenu",name:"customize",title:'{{t("Customize")}}',children:[{type:"item",title:'{{t("Add record")}}',name:"addRecord",Component:"CustomizeAddRecordActionInitializer",schema:{"x-align":"right","x-decorator":"ACLActionProvider","x-acl-action":"create","x-acl-action-props":{skipScopeCheck:!0}}}],useVisible(){const e=d.useCollection_deprecated();return!["view","sql"].includes(e.template)||(e==null?void 0:e.writableView)}}]}),ir=new d.CompatibleSchemaInitializer({name:"gantt:configureActions",title:"{{t('Configure actions')}}",icon:"SettingOutlined",style:{marginLeft:8},items:[{type:"itemGroup",name:"enableActions",title:"{{t('Enable actions')}}",children:[{type:"item",name:"filter",title:"{{t('Filter')}}",Component:"FilterActionInitializer",schema:{"x-align":"left"}},{type:"item",title:"{{t('Add new')}}",name:"addNew",Component:"CreateActionInitializer",schema:{"x-align":"right","x-decorator":"ACLActionProvider","x-acl-action-props":{skipScopeCheck:!0}},useVisible(){const e=d.useCollection_deprecated();return!["view","file","sql"].includes(e.template)||(e==null?void 0:e.writableView)}},{type:"item",title:"{{t('Delete')}}",name:"delete",Component:"BulkDestroyActionInitializer",schema:{"x-align":"right","x-decorator":"ACLActionProvider"},useVisible(){const e=d.useCollection_deprecated();return!["view","sql"].includes(e.template)||(e==null?void 0:e.writableView)}},{type:"item",title:"{{t('Refresh')}}",name:"refresh",Component:"RefreshActionInitializer",schema:{"x-align":"right"}},{name:"toggle",title:"{{t('Expand/Collapse')}}",Component:"ExpandableActionInitializer",schema:{"x-align":"right"},useVisible(){var o;const e=F.useFieldSchema(),t=d.useCollection_deprecated(),{treeTable:r}=((o=e==null?void 0:e.parent)==null?void 0:o["x-decorator-props"])||{};return t.tree&&r}}]},{name:"divider",type:"divider",useVisible(){const e=d.useCollection_deprecated();return!["view","sql"].includes(e.template)||(e==null?void 0:e.writableView)}},{type:"subMenu",name:"customize",title:'{{t("Customize")}}',children:[{type:"item",title:'{{t("Add record")}}',name:"addRecord",Component:"CustomizeAddRecordActionInitializer",schema:{"x-align":"right","x-decorator":"ACLActionProvider","x-acl-action":"create","x-acl-action-props":{skipScopeCheck:!0}}}],useVisible(){const e=d.useCollection_deprecated();return!["view","sql"].includes(e.template)||(e==null?void 0:e.writableView)}}]},gt),lr=e=>{const{collectionName:t,fieldNames:r,dataSource:o}=e;return{type:"void","x-acl-action":`${t}:list`,"x-decorator":"GanttBlockProvider","x-decorator-props":{collection:t,dataSource:o,action:"list",fieldNames:r,params:{paginate:!1}},"x-toolbar":"BlockSchemaToolbar","x-settings":"blockSettings:gantt","x-component":"CardItem",properties:{[se.uid()]:{type:"void","x-component":"Gantt","x-use-component-props":"useGanttBlockProps",properties:{toolBar:{type:"void","x-component":"ActionBar","x-component-props":{style:{marginBottom:24}},"x-initializer":"gantt:configureActions",properties:{}},table:{type:"array","x-decorator":"div","x-decorator-props":{style:{float:"left",maxWidth:"35%"}},"x-initializer":"table:configureColumns","x-component":"TableV2","x-use-component-props":"useTableBlockProps","x-component-props":{rowKey:"id",rowSelection:{type:"checkbox"},pagination:!1},properties:{actions:{type:"void",title:'{{ t("Actions") }}',"x-action-column":"actions","x-decorator":"TableV2.Column.ActionBar","x-component":"TableV2.Column","x-designer":"TableV2.ActionColumnDesigner","x-initializer":"table:configureItemActions",properties:{actions:{type:"void","x-decorator":"DndContext","x-component":"Space","x-component-props":{split:"|"}}}}}},detail:{type:"void","x-component":"Gantt.Event",properties:{drawer:{type:"void","x-component":"Action.Drawer","x-component-props":{className:"nb-action-popup",enablePageTabs:!0},title:'{{ t("View record") }}',"x-settings":"fieldSettings:Drawer",properties:{tabs:{type:"void","x-component":"Tabs","x-component-props":{},"x-initializer":"popup:addTab","x-index":1,properties:{tab1:{type:"void",title:'{{t("Details")}}',"x-component":"Tabs.TabPane","x-designer":"Tabs.Designer","x-component-props":{},properties:{grid:{type:"void","x-component":"Grid","x-initializer":"popup:common:addBlock"}}}}},grid:{type:"void","x-component":"Grid","x-initializer":"popup:common:addBlock","x-display":"hidden","x-index":2}}}}}}}}}},cr=()=>{const{insert:e}=d.useSchemaInitializer(),{t}=me.useTranslation(),{getCollectionFields:r}=d.useCollectionManager_deprecated(),o=g.useContext(F.SchemaOptionsContext),{theme:n}=d.useGlobalTheme(),a=d.useSchemaInitializerItem();return c.jsx(d.DataBlockInitializer,we(X({},a),{componentType:"Gantt",icon:c.jsx(Ke.FormOutlined,{}),onCreateBlockSchema:s=>ae(this,[s],function*({item:i}){var T,b,A;const l=r(i.name,i.dataSource),u=(T=l==null?void 0:l.filter(p=>p.type==="string"))==null?void 0:T.map(p=>{var x;return{label:(x=p==null?void 0:p.uiSchema)==null?void 0:x.title,value:p.name}}),f=(b=l==null?void 0:l.filter(p=>p.type==="date"))==null?void 0:b.map(p=>{var x;return{label:(x=p==null?void 0:p.uiSchema)==null?void 0:x.title,value:p.name}}),y=(A=l==null?void 0:l.filter(p=>p.type==="float"))==null?void 0:A.map(p=>{var x;return{label:(x=p==null?void 0:p.uiSchema)==null?void 0:x.title,value:p.name}}),V=yield d.FormDialog(t("Create gantt block"),()=>c.jsx(d.SchemaComponentOptions,{scope:o.scope,components:X({},o.components),children:c.jsx(Pe.FormLayout,{layout:"vertical",children:c.jsx(d.SchemaComponent,{schema:{properties:{title:{title:t("Title field"),enum:u,required:!0,"x-component":"Select","x-decorator":"FormItem"},start:{title:t("Start date field"),enum:f,required:!0,default:"createdAt","x-component":"Select","x-decorator":"FormItem"},end:{title:t("End date field"),enum:f,required:!0,"x-component":"Select","x-decorator":"FormItem"},progress:{title:t("Progress field"),enum:y,"x-component":"Select","x-decorator":"FormItem"},range:{title:t("Time scale"),enum:[{label:'{{t("Hour")}}',value:"hour",color:"orange"},{label:'{{t("Quarter of day")}}',value:"quarterDay",color:"default"},{label:'{{t("Half of day")}}',value:"halfDay",color:"blue"},{label:'{{t("Day")}}',value:"day",color:"yellow"},{label:'{{t("Week")}}',value:"week",color:"pule"},{label:'{{t("Month")}}',value:"month",color:"green"},{label:'{{t("Year")}}',value:"year",color:"green"},{label:'{{t("QuarterYear")}}',value:"quarterYear",color:"red"}],default:"day","x-component":"Select","x-decorator":"FormItem"}}}})})}),n).open({initialValues:{}});e(lr({collectionName:i.name,dataSource:i.dataSource,fieldNames:X({},V)}))})}))},dr=F.observer(e=>c.jsx(c.Fragment,{children:e.children}),{displayName:"Event"}),ur=(e,t,r,o,n,a,i,s,l,u,f,y,V,T,b,A,p,x)=>{let S=e.map((N,w)=>pr(N,w,t,r,o,n,a,i,s,l,u,f,y,V,T,b,A,p,x));return S=S.map(N=>{const w=N.dependencies||[];for(let m=0;m<w.length;m++){const h=S.findIndex(v=>v.id===w[m]);h!==-1&&S[h].barChildren.push(N)}return N}),S},pr=(e,t,r,o,n,a,i,s,l,u,f,y,V,T,b,A,p,x,S)=>{let N;switch(e.type){case"milestone":N=hr(e,t,r,o,n,a,i,s,x,S);break;case"project":N=mt(e,t,r,o,n,a*.5,i,s,l,T,b,A,p);break;default:N=mt(e,t,r,o,n,a,i,s,l,u,f,y,V);break}return N},mt=(e,t,r,o,n,a,i,s,l,u,f,y,V)=>{let T,b;l?(b=bt(e.start,r,o),T=bt(e.end,r,o)):(T=He(e.start,r,o),b=He(e.end,r,o));let A=e.type;A==="task"&&b-T<s*2&&(A="smalltask",b=T>0?T+s*2:T);const[p,x]=Be(T,b,e.progress,l),S=e.type==="project"?et(t,n,a)+8:et(t,n,a),N=e.type==="project"?e.hideChildren:void 0,w=X({backgroundColor:y,backgroundSelectedColor:V,progressColor:u,progressSelectedColor:f},e.styles);return we(X({},e),{typeInternal:A,x1:T,x2:b,y:S,index:t,progressX:x,progressWidth:p,barCornerRadius:i,handleWidth:s,hideChildren:N,height:a,barChildren:[],styles:w})},hr=(e,t,r,o,n,a,i,s,l,u)=>{const f=He(e.start,r,o),y=et(t,n,a),V=f-a*.5,T=f+a*.5,b=a/1.414,A=X({backgroundColor:l,backgroundSelectedColor:u,progressColor:"",progressSelectedColor:""},e.styles);return we(X({},e),{end:e.start,x1:V,x2:T,y,index:t,progressX:0,progressWidth:0,barCornerRadius:i,handleWidth:s,typeInternal:e.type,progress:0,height:b,hideChildren:void 0,barChildren:[],styles:A})},He=(e,t,r)=>{var s,l,u;const o=t.findIndex(f=>(f==null?void 0:f.getTime())>=(e==null?void 0:e.getTime()))-1,a=((e==null?void 0:e.getTime())-((s=t[o])==null?void 0:s.getTime()))/(((l=t[o+1])==null?void 0:l.getTime())-((u=t[o])==null?void 0:u.getTime())),i=o*r+a*r;return isNaN(i)?0:i},bt=(e,t,r)=>{let o=He(e,t,r);return o+=r,isNaN(o)?0:o},et=(e,t,r)=>{const o=e*t+(t-r)/2;return isNaN(o)?0:o},Be=(e,t,r,o)=>{const n=(t-e)*r*.01;let a;return o?a=t-n:a=e,[n,a]},fr=(e,t)=>{if(e>=t.x2)return 100;if(e<=t.x1)return 0;{const r=t.x2-t.x1;return Math.round((e-t.x1)*100/r)}},gr=(e,t)=>{if(e>=t.x2)return 0;if(e<=t.x1)return 100;{const r=t.x2-t.x1;return Math.round((t.x2-e)*100/r)}},xt=(e,t,r)=>[e-5,t+r,e+5,t+r,e,t+r-8.66].join(","),mr=(e,t,r)=>{e>=r.x2-r.handleWidth*2&&(e=r.x2-r.handleWidth*2);const n=Math.round((e-r.x1)/t)*t;return r.x1+n},br=(e,t,r)=>{e<=r.x1+r.handleWidth*2&&(e=r.x1+r.handleWidth*2);const n=Math.round((e-r.x2)/t)*t;return r.x2+n},yt=(e,t,r)=>{const n=Math.round((e-r.x1)/t)*t,a=r.x1+n,i=a+r.x2-r.x1;return[a,i]},be=(e,t,r,o,n)=>{var i,s;let a=new Date((e-t)/o*n+((i=r==null?void 0:r.getTime)==null?void 0:i.call(r)));return a=new Date(((s=a==null?void 0:a.getTime)==null?void 0:s.call(a))+((a==null?void 0:a.getTimezoneOffset())-(r==null?void 0:r.getTimezoneOffset()))*6e4),a},vt=(e,t,r,o,n,a,i)=>{let s;switch(r.type){case"milestone":s=yr(e,t,r,o,n,a);break;default:s=xr(e,t,r,o,n,a,i);break}return s},xr=(e,t,r,o,n,a,i)=>{const s=X({},r);let l=!1;switch(t){case"progress":if(i?s.progress=gr(e,r):s.progress=fr(e,r),l=s.progress!==r.progress,l){const[u,f]=Be(s.x1,s.x2,s.progress,i);s.progressWidth=u,s.progressX=f}break;case"start":{const u=mr(e,o,r);if(s.x1=u,l=s.x1!==r.x1,l){i?s.end=be(u,r.x1,r.end,o,n):s.start=be(u,r.x1,r.start,o,n);const[f,y]=Be(s.x1,s.x2,s.progress,i);s.progressWidth=f,s.progressX=y}break}case"end":{const u=br(e,o,r);if(s.x2=u,l=s.x2!==r.x2,l){i?s.start=be(u,r.x2,r.start,o,n):s.end=be(u,r.x2,r.end,o,n);const[f,y]=Be(s.x1,s.x2,s.progress,i);s.progressWidth=f,s.progressX=y}break}case"move":{const[u,f]=yt(e-a,o,r);if(l=u!==r.x1,l){s.start=be(u,r.x1,r.start,o,n),s.end=be(f,r.x2,r.end,o,n),s.x1=u,s.x2=f;const[y,V]=Be(s.x1,s.x2,s.progress,i);s.progressWidth=y,s.progressX=V}break}}return{isChanged:l,changedTask:s}},yr=(e,t,r,o,n,a)=>{const i=X({},r);let s=!1;switch(t){case"move":{const[l,u]=yt(e-a,o,r);s=l!==r.x1,s&&(i.start=be(l,r.x1,r.start,o,n),i.end=i.start,i.x1=l,i.x2=u);break}}return{isChanged:s,changedTask:i}};var z=(e=>(e.Hour="hour",e.QuarterDay="quarterDay",e.HalfDay="halfDay",e.Day="day",e.Week="week",e.Month="month",e.QuarterYear="quarterYear",e.Year="year",e))(z||{});const St={},Ge=(e,t={})=>{const r=JSON.stringify([e,t]);let o=St[r];return o||(o=new Intl.DateTimeFormat(e,t),St[r]=o),o},H=(e,t,r)=>new Date(e.getFullYear()+(r==="year"?t:0),e.getMonth()+(r==="month"?t:0),e.getDate()+(r==="day"?t:0),e.getHours()+(r==="hour"?t:0),e.getMinutes()+(r==="minute"?t:0),e.getSeconds()+(r==="second"?t:0),e.getMilliseconds()+(r==="millisecond"?t:0)),j=(e,t)=>{const r=["millisecond","second","minute","hour","day","month","year"],o=a=>{const i=r.indexOf(t);return r.indexOf(a)<=i};return new Date(e==null?void 0:e.getFullYear(),o("year")?0:e.getMonth(),o("month")?1:e.getDate(),o("day")?0:e.getHours(),o("hour")?0:e.getMinutes(),o("minute")?0:e.getSeconds(),o("second")?0:e.getMilliseconds())},wt=(e,t,r)=>{var a,i;let o=((a=e[0])==null?void 0:a.start)||new Date,n=((i=e[0])==null?void 0:i.start)||new Date;for(const s of e)s.start<o&&(o=s.start),s.end>n&&(n=s.end);switch(t){case z.Year:o=H(o,-1,"year"),o=j(o,"year"),n=H(n,1,"year"),n=j(n,"year");break;case z.QuarterYear:o=H(o,-3,"month"),o=j(o,"month"),n=H(n,3,"year"),n=j(n,"year");break;case z.Month:o=H(o,-1*r,"month"),o=j(o,"month"),n=H(n,1,"year"),n=j(n,"year");break;case z.Week:o=j(o,"day"),o=H(vr(o),-7*r,"day"),n=j(n,"day"),n=H(n,1.5,"month");break;case z.Day:o=j(o,"day"),o=H(o,-1*r,"day"),n=j(n,"day"),n=H(n,19,"day");break;case z.QuarterDay:o=j(o,"day"),o=H(o,-1*r,"day"),n=j(n,"day"),n=H(n,66,"hour");break;case z.HalfDay:o=j(o,"day"),o=H(o,-1*r,"day"),n=j(n,"day"),n=H(n,108,"hour");break;case z.Hour:o=j(o,"hour"),o=H(o,-1*r,"hour"),n=j(n,"day"),n=H(n,1,"day");break}return[o,n]},Ct=(e,t,r)=>{let o=new Date(e);const n=[o];for(;o<t;){switch(r){case z.Year:o=H(o,1,"year");break;case z.QuarterYear:o=H(o,3,"month");break;case z.Month:o=H(o,1,"month");break;case z.Week:o=H(o,7,"day");break;case z.Day:o=H(o,1,"day");break;case z.HalfDay:o=H(o,12,"hour");break;case z.QuarterDay:o=H(o,6,"hour");break;case z.Hour:o=H(o,1,"hour");break}n.push(o)}return n},Fe=(e,t)=>{let r=Ge(t,{month:"long"}).format(e);return r=r.replace(r[0],r[0].toLocaleUpperCase()),r},Tt=(e,t,r)=>{let o=Ge(t,{weekday:r}).format(e);return o=o.replace(o[0],o[0].toLocaleUpperCase()),o},vr=e=>{const t=e.getDay(),r=e.getDate()-t+(t===0?-6:1);return new Date(e.setDate(r))},Sr=e=>{const t=new Date(e.valueOf()),r=(t.getDay()+6)%7;t.setDate(t.getDate()-r+3);const o=t.valueOf();t.setMonth(0,1),t.getDay()!==4&&t.setMonth(0,1+(4-t.getDay()+7)%7);const n=(1+Math.ceil((o-t.valueOf())/6048e5)).toString();return n.length===1?`0${n}`:n},wr=(e,t)=>new Date(t,e+1,0).getDate();function Cr(e){return e.key!==void 0}function Tr(e){const t=e.filter(r=>r.hideChildren&&r.type==="project");if(t.length>0)for(let r=0;t.length>r;r++){const o=t[r],n=Nt(e,o);e=e.filter(a=>n.indexOf(a)===-1)}return e}function Nt(e,t){let r=[];t.type!=="project"?r=e.filter(n=>n.dependencies&&n.dependencies.indexOf(t.id)!==-1):r=e.filter(n=>n.project&&n.project===t.id);const o=[];return r.forEach(n=>{o.push(...Nt(e,n))}),r=r.concat(r,o),r}const Nr=(e,t)=>{const r=e.displayOrder||Number.MAX_VALUE,o=t.displayOrder||Number.MAX_VALUE;return r>o?1:r<o?-1:0},Ce=e=>{var t;return isNaN((t=e==null?void 0:e.getTime)==null?void 0:t.call(e))?0:e.getFullYear()+`/${e.getMonth()+1}/`+e.getDate()},Oe=Ee.createStyles(({token:e,css:t})=>({scrollWrapper:t`
      overflow: auto;
      position: absolute;
      bottom: -8px;
      max-width: 100%;
      scrollbarWidth: thin;
      height: 1.2rem;
      &::-webkit-scrollbar: { width: 8, height: 8 };
      &::-webkit-scrollbar-corner: { background: transparent };
      &::-webkit-scrollbar-track: { background: var(--colorBgScrollTrack) };
      &::-webkit-scrollbar-thumb: {
        background: var(--colorBgScrollBar);
        borderRadius: 4;
      };
      &::-webkit-scrollbar-thumb:hover: {
        background: var(--colorBgScrollBarHover);
      };
      &::-webkit-scrollbar-thumb:active: {
        background: var(--colorBgScrollBarActive)
      }
    `,tooltipDefaultContainer:t`
      padding: 12px;
      background-color: ${e.colorBgElevated};
      background-clip: padding-box;
      border-radius: ${e.borderRadius};
      box-shadow: ${e.boxShadow};
      b: {
        display: block;
        margin-bottom: ${e.marginXS};
      }
      .tooltipdefaultcontainerparagraph: {
        font-size: ${e.fontSizeSM};
        margin-bottom: ${e.marginXXS} + ${e.marginXS-e.marginXXS};
        color: ${e.colorText};
      }
    `,tooltipDetailsContainer:t`
      position: absolute;
      display: flex;
      flexshrink: 0;
      pointerevents: none;
      webkittouchcallout: none;
      webkituserselect: none;
      mozuserselect: none;
      msuserselect: none;
      userselect: none;
    `,tooltipDetailsContainerHidden:t`
      visibility: hidden;
      position: absolute;
      display: flex;
      pointerevents: none;
    `,nbGridOther:t`
       .horizontalScroll: {
        height: 1
        }
  
      .verticalScroll: {
        overflow: hidden auto;
        width: 1rem;
        flexShrink: 0;
        scrollbarWidth: thin;
        &::-webkit-scrollbar: { width: 8, height: 8 };
        &::-webkit-scrollbar-corner: { background: transparent};
        &::-webkit-scrollbar-track: { background: var(--colorBgScrollTrack) };
        &::-webkit-scrollbar-thumb: {
          background: var(--colorBgScrollBar);
          borderRadius: 4;
        }
        &::-webkit-scrollbar-thumb:hover': {
          background: var(--colorBgScrollBarHover)
        }
        &::-webkit-scrollbar-thumb:active': {
          background: var(--colorBgScrollBarActive)
        },
      }
    }
   `})),Mr=({scroll:e,svgWidth:t,taskListWidth:r,rtl:o,onScroll:n})=>{const{styles:a}=Oe(),i=g.useRef(null);return g.useEffect(()=>{i.current&&(i.current.scrollLeft=e)},[e]),c.jsx("div",{dir:"ltr",style:{margin:o?`0px ${r}px 0px 0px`:`0px 0px 0px ${r}px`},className:M.cx(a.nbGridOther,a.scrollWrapper,"gantt-horizontal-scoll"),onScroll:n,ref:i,children:c.jsx("div",{style:{width:t,height:1},className:"horizontalScroll"})})},Dr=({task:e,rowHeight:t,rtl:r,svgContainerHeight:o,svgContainerWidth:n,scrollX:a,scrollY:i,arrowIndent:s,fontSize:l,fontFamily:u,headerHeight:f,taskListWidth:y,TooltipContent:V})=>{const{styles:T}=Oe(),b=g.useRef(null),[A,p]=g.useState(0),[x,S]=g.useState(0);return g.useEffect(()=>{if(b.current){const N=b.current.offsetHeight*1.1,w=b.current.offsetWidth*1.1;let m=e.index*t-i+f,h;if(r)h=e.x1-s*1.5-w-a,h<0&&(h=e.x2+s*1.5-a),w+h>n&&(h=n-w,m+=t);else{h=e.x2+s*1.5+y-a;const P=w+h,L=y+n;P>L&&(h=e.x1+y-s*1.5-a-w),h<y&&(h=n+y-w,m+=t)}N+m-i>o-i&&(m=o-N),p(m),S(h)}},[b,e,s,a,i,f,y,t,o,n,r]),c.jsx("div",{ref:b,className:M.cx(x?T.tooltipDetailsContainer:T.tooltipDetailsContainerHidden,T.nbGridOther),style:{left:x,top:A},children:c.jsx(V,{task:e,fontSize:l,fontFamily:u})})},Pr=({task:e,fontSize:t,fontFamily:r})=>{var a,i,s,l,u,f,y,V;const{styles:o}=Oe(),n={fontSize:t,fontFamily:r};return c.jsxs("div",{className:M.cx(o.nbGridOther,o.tooltipDefaultContainer),"aria-label":"nb-gantt-tooltip",style:n,children:[c.jsxs("b",{style:{fontSize:t},children:[e.name,": ",Ce(e.start)," ~ ",Ce(e.end)]}),((i=(a=e.end)==null?void 0:a.getTime)==null?void 0:i.call(a))-((l=(s=e.start)==null?void 0:s.getTime)==null?void 0:l.call(s))!==0&&c.jsx("p",{className:"tooltipDefaultContainerParagraph",children:`Duration: ${Math.round((((f=(u=e.end)==null?void 0:u.getTime)==null?void 0:f.call(u))-((V=(y=e.start)==null?void 0:y.getTime)==null?void 0:V.call(y)))/(1e3*60*60*24)*10)/10||""} day(s)`}),c.jsx("p",{className:"tooltipDefaultContainerParagraph",children:!!e.progress&&`Progress: ${e.progress}%`})]})},Br=({scroll:e,ganttHeight:t,ganttFullHeight:r,headerHeight:o,rtl:n,onScroll:a})=>{const{styles:i}=Oe(),s=g.useRef(null);return g.useEffect(()=>{s.current&&(s.current.scrollTop=e)},[e]),c.jsx("div",{style:{maxHeight:t,marginTop:o,marginLeft:n?"":"-1rem"},className:M.cx(i.nbGridOther,"verticalScroll"),onScroll:a,ref:s,children:c.jsx("div",{style:{height:r,width:1}})})},Mt=d.createStyles(({token:e,css:t})=>({ganttverticalcontainer:t`
      overflow: hidden;
      font-size: 0;
      margin: 0;
      padding: 0;
      width: 100%;
      border-left: 2px solid ${e.colorBorderSecondary};
      overflow-x: auto;
      .ganttheader: {
        border-bottom: 1px solid ${e.colorBorderSecondary};
        font-weight: 700;
      }
      .ganttbody: {
        border-bottom: 1px solid ${e.colorBorderSecondary};
      }
    `,horizontalcontainer:t`
      margin: 0;
      padding: 0;
      overflow: hidden;
      margin-bottom: -5px;
    `,wrapper:t`
      display: flex;
      padding: 0;
      margin: 0;
      liststyle: none;
      outline: none;
      position: relative;
      .gantt-horizontal-scoll: {
        display: none;
      }
      &:hover: {
        .gantt-horizontal-scoll: {
          display: block;
        }
      }
    `}));function Y(e,t){Fr(e)&&(e="100%");var r=Ar(e);return e=t===360?e:Math.min(t,Math.max(0,parseFloat(e))),r&&(e=parseInt(String(e*t),10)/100),Math.abs(e-t)<1e-6?1:(t===360?e=(e<0?e%t+t:e%t)/parseFloat(String(t)):e=e%t/parseFloat(String(t)),e)}function Xe(e){return Math.min(1,Math.max(0,e))}function Fr(e){return typeof e=="string"&&e.indexOf(".")!==-1&&parseFloat(e)===1}function Ar(e){return typeof e=="string"&&e.indexOf("%")!==-1}function Dt(e){return e=parseFloat(e),(isNaN(e)||e<0||e>1)&&(e=1),e}function Ye(e){return e<=1?"".concat(Number(e)*100,"%"):e}function xe(e){return e.length===1?"0"+e:String(e)}function $r(e,t,r){return{r:Y(e,255)*255,g:Y(t,255)*255,b:Y(r,255)*255}}function Pt(e,t,r){e=Y(e,255),t=Y(t,255),r=Y(r,255);var o=Math.max(e,t,r),n=Math.min(e,t,r),a=0,i=0,s=(o+n)/2;if(o===n)i=0,a=0;else{var l=o-n;switch(i=s>.5?l/(2-o-n):l/(o+n),o){case e:a=(t-r)/l+(t<r?6:0);break;case t:a=(r-e)/l+2;break;case r:a=(e-t)/l+4;break}a/=6}return{h:a,s:i,l:s}}function tt(e,t,r){return r<0&&(r+=1),r>1&&(r-=1),r<1/6?e+(t-e)*(6*r):r<1/2?t:r<2/3?e+(t-e)*(2/3-r)*6:e}function Vr(e,t,r){var o,n,a;if(e=Y(e,360),t=Y(t,100),r=Y(r,100),t===0)n=r,a=r,o=r;else{var i=r<.5?r*(1+t):r+t-r*t,s=2*r-i;o=tt(s,i,e+1/3),n=tt(s,i,e),a=tt(s,i,e-1/3)}return{r:o*255,g:n*255,b:a*255}}function Bt(e,t,r){e=Y(e,255),t=Y(t,255),r=Y(r,255);var o=Math.max(e,t,r),n=Math.min(e,t,r),a=0,i=o,s=o-n,l=o===0?0:s/o;if(o===n)a=0;else{switch(o){case e:a=(t-r)/s+(t<r?6:0);break;case t:a=(r-e)/s+2;break;case r:a=(e-t)/s+4;break}a/=6}return{h:a,s:l,v:i}}function Ir(e,t,r){e=Y(e,360)*6,t=Y(t,100),r=Y(r,100);var o=Math.floor(e),n=e-o,a=r*(1-t),i=r*(1-n*t),s=r*(1-(1-n)*t),l=o%6,u=[r,i,a,a,s,r][l],f=[s,r,r,i,a,a][l],y=[a,a,s,r,r,i][l];return{r:u*255,g:f*255,b:y*255}}function Ft(e,t,r,o){var n=[xe(Math.round(e).toString(16)),xe(Math.round(t).toString(16)),xe(Math.round(r).toString(16))];return o&&n[0].startsWith(n[0].charAt(1))&&n[1].startsWith(n[1].charAt(1))&&n[2].startsWith(n[2].charAt(1))?n[0].charAt(0)+n[1].charAt(0)+n[2].charAt(0):n.join("")}function Lr(e,t,r,o,n){var a=[xe(Math.round(e).toString(16)),xe(Math.round(t).toString(16)),xe(Math.round(r).toString(16)),xe(kr(o))];return n&&a[0].startsWith(a[0].charAt(1))&&a[1].startsWith(a[1].charAt(1))&&a[2].startsWith(a[2].charAt(1))&&a[3].startsWith(a[3].charAt(1))?a[0].charAt(0)+a[1].charAt(0)+a[2].charAt(0)+a[3].charAt(0):a.join("")}function kr(e){return Math.round(parseFloat(e)*255).toString(16)}function At(e){return Q(e)/255}function Q(e){return parseInt(e,16)}function Er(e){return{r:e>>16,g:(e&65280)>>8,b:e&255}}var rt={aliceblue:"#f0f8ff",antiquewhite:"#faebd7",aqua:"#00ffff",aquamarine:"#7fffd4",azure:"#f0ffff",beige:"#f5f5dc",bisque:"#ffe4c4",black:"#000000",blanchedalmond:"#ffebcd",blue:"#0000ff",blueviolet:"#8a2be2",brown:"#a52a2a",burlywood:"#deb887",cadetblue:"#5f9ea0",chartreuse:"#7fff00",chocolate:"#d2691e",coral:"#ff7f50",cornflowerblue:"#6495ed",cornsilk:"#fff8dc",crimson:"#dc143c",cyan:"#00ffff",darkblue:"#00008b",darkcyan:"#008b8b",darkgoldenrod:"#b8860b",darkgray:"#a9a9a9",darkgreen:"#006400",darkgrey:"#a9a9a9",darkkhaki:"#bdb76b",darkmagenta:"#8b008b",darkolivegreen:"#556b2f",darkorange:"#ff8c00",darkorchid:"#9932cc",darkred:"#8b0000",darksalmon:"#e9967a",darkseagreen:"#8fbc8f",darkslateblue:"#483d8b",darkslategray:"#2f4f4f",darkslategrey:"#2f4f4f",darkturquoise:"#00ced1",darkviolet:"#9400d3",deeppink:"#ff1493",deepskyblue:"#00bfff",dimgray:"#696969",dimgrey:"#696969",dodgerblue:"#1e90ff",firebrick:"#b22222",floralwhite:"#fffaf0",forestgreen:"#228b22",fuchsia:"#ff00ff",gainsboro:"#dcdcdc",ghostwhite:"#f8f8ff",goldenrod:"#daa520",gold:"#ffd700",gray:"#808080",green:"#008000",greenyellow:"#adff2f",grey:"#808080",honeydew:"#f0fff0",hotpink:"#ff69b4",indianred:"#cd5c5c",indigo:"#4b0082",ivory:"#fffff0",khaki:"#f0e68c",lavenderblush:"#fff0f5",lavender:"#e6e6fa",lawngreen:"#7cfc00",lemonchiffon:"#fffacd",lightblue:"#add8e6",lightcoral:"#f08080",lightcyan:"#e0ffff",lightgoldenrodyellow:"#fafad2",lightgray:"#d3d3d3",lightgreen:"#90ee90",lightgrey:"#d3d3d3",lightpink:"#ffb6c1",lightsalmon:"#ffa07a",lightseagreen:"#20b2aa",lightskyblue:"#87cefa",lightslategray:"#778899",lightslategrey:"#778899",lightsteelblue:"#b0c4de",lightyellow:"#ffffe0",lime:"#00ff00",limegreen:"#32cd32",linen:"#faf0e6",magenta:"#ff00ff",maroon:"#800000",mediumaquamarine:"#66cdaa",mediumblue:"#0000cd",mediumorchid:"#ba55d3",mediumpurple:"#9370db",mediumseagreen:"#3cb371",mediumslateblue:"#7b68ee",mediumspringgreen:"#00fa9a",mediumturquoise:"#48d1cc",mediumvioletred:"#c71585",midnightblue:"#191970",mintcream:"#f5fffa",mistyrose:"#ffe4e1",moccasin:"#ffe4b5",navajowhite:"#ffdead",navy:"#000080",oldlace:"#fdf5e6",olive:"#808000",olivedrab:"#6b8e23",orange:"#ffa500",orangered:"#ff4500",orchid:"#da70d6",palegoldenrod:"#eee8aa",palegreen:"#98fb98",paleturquoise:"#afeeee",palevioletred:"#db7093",papayawhip:"#ffefd5",peachpuff:"#ffdab9",peru:"#cd853f",pink:"#ffc0cb",plum:"#dda0dd",powderblue:"#b0e0e6",purple:"#800080",rebeccapurple:"#663399",red:"#ff0000",rosybrown:"#bc8f8f",royalblue:"#4169e1",saddlebrown:"#8b4513",salmon:"#fa8072",sandybrown:"#f4a460",seagreen:"#2e8b57",seashell:"#fff5ee",sienna:"#a0522d",silver:"#c0c0c0",skyblue:"#87ceeb",slateblue:"#6a5acd",slategray:"#708090",slategrey:"#708090",snow:"#fffafa",springgreen:"#00ff7f",steelblue:"#4682b4",tan:"#d2b48c",teal:"#008080",thistle:"#d8bfd8",tomato:"#ff6347",turquoise:"#40e0d0",violet:"#ee82ee",wheat:"#f5deb3",white:"#ffffff",whitesmoke:"#f5f5f5",yellow:"#ffff00",yellowgreen:"#9acd32"};function zr(e){var t={r:0,g:0,b:0},r=1,o=null,n=null,a=null,i=!1,s=!1;return typeof e=="string"&&(e=Or(e)),typeof e=="object"&&(ie(e.r)&&ie(e.g)&&ie(e.b)?(t=$r(e.r,e.g,e.b),i=!0,s=String(e.r).substr(-1)==="%"?"prgb":"rgb"):ie(e.h)&&ie(e.s)&&ie(e.v)?(o=Ye(e.s),n=Ye(e.v),t=Ir(e.h,o,n),i=!0,s="hsv"):ie(e.h)&&ie(e.s)&&ie(e.l)&&(o=Ye(e.s),a=Ye(e.l),t=Vr(e.h,o,a),i=!0,s="hsl"),Object.prototype.hasOwnProperty.call(e,"a")&&(r=e.a)),r=Dt(r),{ok:i,format:e.format||s,r:Math.min(255,Math.max(t.r,0)),g:Math.min(255,Math.max(t.g,0)),b:Math.min(255,Math.max(t.b,0)),a:r}}var Hr="[-\\+]?\\d+%?",Gr="[-\\+]?\\d*\\.\\d+%?",fe="(?:".concat(Gr,")|(?:").concat(Hr,")"),ot="[\\s|\\(]+(".concat(fe,")[,|\\s]+(").concat(fe,")[,|\\s]+(").concat(fe,")\\s*\\)?"),nt="[\\s|\\(]+(".concat(fe,")[,|\\s]+(").concat(fe,")[,|\\s]+(").concat(fe,")[,|\\s]+(").concat(fe,")\\s*\\)?"),R={CSS_UNIT:new RegExp(fe),rgb:new RegExp("rgb"+ot),rgba:new RegExp("rgba"+nt),hsl:new RegExp("hsl"+ot),hsla:new RegExp("hsla"+nt),hsv:new RegExp("hsv"+ot),hsva:new RegExp("hsva"+nt),hex3:/^#?([0-9a-fA-F]{1})([0-9a-fA-F]{1})([0-9a-fA-F]{1})$/,hex6:/^#?([0-9a-fA-F]{2})([0-9a-fA-F]{2})([0-9a-fA-F]{2})$/,hex4:/^#?([0-9a-fA-F]{1})([0-9a-fA-F]{1})([0-9a-fA-F]{1})([0-9a-fA-F]{1})$/,hex8:/^#?([0-9a-fA-F]{2})([0-9a-fA-F]{2})([0-9a-fA-F]{2})([0-9a-fA-F]{2})$/};function Or(e){if(e=e.trim().toLowerCase(),e.length===0)return!1;var t=!1;if(rt[e])e=rt[e],t=!0;else if(e==="transparent")return{r:0,g:0,b:0,a:0,format:"name"};var r=R.rgb.exec(e);return r?{r:r[1],g:r[2],b:r[3]}:(r=R.rgba.exec(e),r?{r:r[1],g:r[2],b:r[3],a:r[4]}:(r=R.hsl.exec(e),r?{h:r[1],s:r[2],l:r[3]}:(r=R.hsla.exec(e),r?{h:r[1],s:r[2],l:r[3],a:r[4]}:(r=R.hsv.exec(e),r?{h:r[1],s:r[2],v:r[3]}:(r=R.hsva.exec(e),r?{h:r[1],s:r[2],v:r[3],a:r[4]}:(r=R.hex8.exec(e),r?{r:Q(r[1]),g:Q(r[2]),b:Q(r[3]),a:At(r[4]),format:t?"name":"hex8"}:(r=R.hex6.exec(e),r?{r:Q(r[1]),g:Q(r[2]),b:Q(r[3]),format:t?"name":"hex"}:(r=R.hex4.exec(e),r?{r:Q(r[1]+r[1]),g:Q(r[2]+r[2]),b:Q(r[3]+r[3]),a:At(r[4]+r[4]),format:t?"name":"hex8"}:(r=R.hex3.exec(e),r?{r:Q(r[1]+r[1]),g:Q(r[2]+r[2]),b:Q(r[3]+r[3]),format:t?"name":"hex"}:!1)))))))))}function ie(e){return!!R.CSS_UNIT.exec(String(e))}var Xr=function(){function e(t,r){t===void 0&&(t=""),r===void 0&&(r={});var o;if(t instanceof e)return t;typeof t=="number"&&(t=Er(t)),this.originalInput=t;var n=zr(t);this.originalInput=t,this.r=n.r,this.g=n.g,this.b=n.b,this.a=n.a,this.roundA=Math.round(100*this.a)/100,this.format=(o=r.format)!==null&&o!==void 0?o:n.format,this.gradientType=r.gradientType,this.r<1&&(this.r=Math.round(this.r)),this.g<1&&(this.g=Math.round(this.g)),this.b<1&&(this.b=Math.round(this.b)),this.isValid=n.ok}return e.prototype.isDark=function(){return this.getBrightness()<128},e.prototype.isLight=function(){return!this.isDark()},e.prototype.getBrightness=function(){var t=this.toRgb();return(t.r*299+t.g*587+t.b*114)/1e3},e.prototype.getLuminance=function(){var t=this.toRgb(),r,o,n,a=t.r/255,i=t.g/255,s=t.b/255;return a<=.03928?r=a/12.92:r=Math.pow((a+.055)/1.055,2.4),i<=.03928?o=i/12.92:o=Math.pow((i+.055)/1.055,2.4),s<=.03928?n=s/12.92:n=Math.pow((s+.055)/1.055,2.4),.2126*r+.7152*o+.0722*n},e.prototype.getAlpha=function(){return this.a},e.prototype.setAlpha=function(t){return this.a=Dt(t),this.roundA=Math.round(100*this.a)/100,this},e.prototype.isMonochrome=function(){var t=this.toHsl().s;return t===0},e.prototype.toHsv=function(){var t=Bt(this.r,this.g,this.b);return{h:t.h*360,s:t.s,v:t.v,a:this.a}},e.prototype.toHsvString=function(){var t=Bt(this.r,this.g,this.b),r=Math.round(t.h*360),o=Math.round(t.s*100),n=Math.round(t.v*100);return this.a===1?"hsv(".concat(r,", ").concat(o,"%, ").concat(n,"%)"):"hsva(".concat(r,", ").concat(o,"%, ").concat(n,"%, ").concat(this.roundA,")")},e.prototype.toHsl=function(){var t=Pt(this.r,this.g,this.b);return{h:t.h*360,s:t.s,l:t.l,a:this.a}},e.prototype.toHslString=function(){var t=Pt(this.r,this.g,this.b),r=Math.round(t.h*360),o=Math.round(t.s*100),n=Math.round(t.l*100);return this.a===1?"hsl(".concat(r,", ").concat(o,"%, ").concat(n,"%)"):"hsla(".concat(r,", ").concat(o,"%, ").concat(n,"%, ").concat(this.roundA,")")},e.prototype.toHex=function(t){return t===void 0&&(t=!1),Ft(this.r,this.g,this.b,t)},e.prototype.toHexString=function(t){return t===void 0&&(t=!1),"#"+this.toHex(t)},e.prototype.toHex8=function(t){return t===void 0&&(t=!1),Lr(this.r,this.g,this.b,this.a,t)},e.prototype.toHex8String=function(t){return t===void 0&&(t=!1),"#"+this.toHex8(t)},e.prototype.toHexShortString=function(t){return t===void 0&&(t=!1),this.a===1?this.toHexString(t):this.toHex8String(t)},e.prototype.toRgb=function(){return{r:Math.round(this.r),g:Math.round(this.g),b:Math.round(this.b),a:this.a}},e.prototype.toRgbString=function(){var t=Math.round(this.r),r=Math.round(this.g),o=Math.round(this.b);return this.a===1?"rgb(".concat(t,", ").concat(r,", ").concat(o,")"):"rgba(".concat(t,", ").concat(r,", ").concat(o,", ").concat(this.roundA,")")},e.prototype.toPercentageRgb=function(){var t=function(r){return"".concat(Math.round(Y(r,255)*100),"%")};return{r:t(this.r),g:t(this.g),b:t(this.b),a:this.a}},e.prototype.toPercentageRgbString=function(){var t=function(r){return Math.round(Y(r,255)*100)};return this.a===1?"rgb(".concat(t(this.r),"%, ").concat(t(this.g),"%, ").concat(t(this.b),"%)"):"rgba(".concat(t(this.r),"%, ").concat(t(this.g),"%, ").concat(t(this.b),"%, ").concat(this.roundA,")")},e.prototype.toName=function(){if(this.a===0)return"transparent";if(this.a<1)return!1;for(var t="#"+Ft(this.r,this.g,this.b,!1),r=0,o=Object.entries(rt);r<o.length;r++){var n=o[r],a=n[0],i=n[1];if(t===i)return a}return!1},e.prototype.toString=function(t){var r=!!t;t=t!=null?t:this.format;var o=!1,n=this.a<1&&this.a>=0,a=!r&&n&&(t.startsWith("hex")||t==="name");return a?t==="name"&&this.a===0?this.toName():this.toRgbString():(t==="rgb"&&(o=this.toRgbString()),t==="prgb"&&(o=this.toPercentageRgbString()),(t==="hex"||t==="hex6")&&(o=this.toHexString()),t==="hex3"&&(o=this.toHexString(!0)),t==="hex4"&&(o=this.toHex8String(!0)),t==="hex8"&&(o=this.toHex8String()),t==="name"&&(o=this.toName()),t==="hsl"&&(o=this.toHslString()),t==="hsv"&&(o=this.toHsvString()),o||this.toHexString())},e.prototype.toNumber=function(){return(Math.round(this.r)<<16)+(Math.round(this.g)<<8)+Math.round(this.b)},e.prototype.clone=function(){return new e(this.toString())},e.prototype.lighten=function(t){t===void 0&&(t=10);var r=this.toHsl();return r.l+=t/100,r.l=Xe(r.l),new e(r)},e.prototype.brighten=function(t){t===void 0&&(t=10);var r=this.toRgb();return r.r=Math.max(0,Math.min(255,r.r-Math.round(255*-(t/100)))),r.g=Math.max(0,Math.min(255,r.g-Math.round(255*-(t/100)))),r.b=Math.max(0,Math.min(255,r.b-Math.round(255*-(t/100)))),new e(r)},e.prototype.darken=function(t){t===void 0&&(t=10);var r=this.toHsl();return r.l-=t/100,r.l=Xe(r.l),new e(r)},e.prototype.tint=function(t){return t===void 0&&(t=10),this.mix("white",t)},e.prototype.shade=function(t){return t===void 0&&(t=10),this.mix("black",t)},e.prototype.desaturate=function(t){t===void 0&&(t=10);var r=this.toHsl();return r.s-=t/100,r.s=Xe(r.s),new e(r)},e.prototype.saturate=function(t){t===void 0&&(t=10);var r=this.toHsl();return r.s+=t/100,r.s=Xe(r.s),new e(r)},e.prototype.greyscale=function(){return this.desaturate(100)},e.prototype.spin=function(t){var r=this.toHsl(),o=(r.h+t)%360;return r.h=o<0?360+o:o,new e(r)},e.prototype.mix=function(t,r){r===void 0&&(r=50);var o=this.toRgb(),n=new e(t).toRgb(),a=r/100,i={r:(n.r-o.r)*a+o.r,g:(n.g-o.g)*a+o.g,b:(n.b-o.b)*a+o.b,a:(n.a-o.a)*a+o.a};return new e(i)},e.prototype.analogous=function(t,r){t===void 0&&(t=6),r===void 0&&(r=30);var o=this.toHsl(),n=360/r,a=[this];for(o.h=(o.h-(n*t>>1)+720)%360;--t;)o.h=(o.h+n)%360,a.push(new e(o));return a},e.prototype.complement=function(){var t=this.toHsl();return t.h=(t.h+180)%360,new e(t)},e.prototype.monochromatic=function(t){t===void 0&&(t=6);for(var r=this.toHsv(),o=r.h,n=r.s,a=r.v,i=[],s=1/t;t--;)i.push(new e({h:o,s:n,v:a})),a=(a+s)%1;return i},e.prototype.splitcomplement=function(){var t=this.toHsl(),r=t.h;return[this,new e({h:(r+72)%360,s:t.s,l:t.l}),new e({h:(r+216)%360,s:t.s,l:t.l})]},e.prototype.onBackground=function(t){var r=this.toRgb(),o=new e(t).toRgb(),n=r.a+o.a*(1-r.a);return new e({r:(r.r*r.a+o.r*o.a*(1-r.a))/n,g:(r.g*r.a+o.g*o.a*(1-r.a))/n,b:(r.b*r.a+o.b*o.a*(1-r.a))/n,a:n})},e.prototype.triad=function(){return this.polyad(3)},e.prototype.tetrad=function(){return this.polyad(4)},e.prototype.polyad=function(t){for(var r=this.toHsl(),o=r.h,n=[this],a=360/t,i=1;i<t;i++)n.push(new e({h:(o+i*a)%360,s:r.s,l:r.l}));return n},e.prototype.equals=function(t){return this.toRgbString()===new e(t).toRgbString()},e}();const Yr=Ee.createStyles(({token:e,css:t})=>{const r=new Xr(e.colorFillAlter).onBackground(e.colorBgContainer).toHexShortString();return{calendarheader:t`
      color: ${e.colorText};
      fill: ${r};
      stroke-width: 1.4;
      background: ${r};
      border-bottom: 1px solid ${e.colorBorderSecondary};
    `,nbGanttCalendar:t`
      .calendarbottomtext: {
        textanchor: middle;
        fill: ${e.colorText};
        webkittouchcallout: none;
        webkituserselect: none;
        mozuserselect: none;
        msuserselect: none;
        userselect: none;
        pointerevents: none;
        font-weight: 500;
      }
      .calendartoptick: {
        stroke: ${e.colorBorderSecondary};
        stroke-width: 0;
      }
      .calendartoptext: {
        textanchor: middle;
        webkittouchcallout: none;
        webkituserselect: none;
        mozuserselect: none;
        msuserselect: none;
        userselect: none;
        pointerevents: none;
        font-weight: 500;
        fill: ${e.colorText};
      }
    `}}),ye=({value:e,x1Line:t,y1Line:r,y2Line:o,xText:n,yText:a})=>c.jsxs("g",{className:"calendarTop",children:[c.jsx("line",{x1:t,y1:r,x2:t,y2:o,className:M.cx("calendarTopTick")},e+"line"),c.jsx("text",{y:a,x:n,className:M.cx("calendarTopText"),children:e},e+"text")]}),jr=({dateSetup:e,locale:t,viewMode:r,rtl:o,headerHeight:n,columnWidth:a,fontFamily:i,fontSize:s})=>{const{styles:l}=Yr(),u=()=>{const S=[],N=[],w=n*.5;for(let m=0;m<e.dates.length;m++){const h=e.dates[m],v=h.getFullYear();if(N.push(c.jsx("text",{y:n*.8,x:a*m+a*.5,className:M.cx("calendarBottomText"),children:v},h.getTime())),m===0||h.getFullYear()!==e.dates[m-1].getFullYear()){const P=h.getFullYear().toString();let L;o?L=(6+m+h.getFullYear()+1)*a:L=(6+m-h.getFullYear())*a,S.push(c.jsx(ye,{value:P,x1Line:a*m,y1Line:0,y2Line:n,xText:L,yText:w*.9},P))}}return[S,N]},f=()=>{const S=[],N=[],w=n*.5;for(let m=0;m<e.dates.length;m++){const h=e.dates[m],v="Q"+Math.floor((h.getMonth()+3)/3);if(N.push(c.jsx("text",{y:n*.8,x:a*m+a*.5,className:M.cx("calendarBottomText"),children:v},h.getTime())),m===0||h.getFullYear()!==e.dates[m-1].getFullYear()){const P=h.getFullYear().toString();let L;o?L=(6+m+h.getMonth()+1)*a:L=(6+m-h.getMonth())*a,S.push(c.jsx(ye,{value:P,x1Line:a*m,y1Line:0,y2Line:w,xText:Math.abs(L),yText:w*.9},P))}}return[S,N]},y=()=>{const S=[],N=[],w=n*.5;for(let m=0;m<e.dates.length;m++){const h=e.dates[m],v=Fe(h,t);if(N.push(c.jsx("text",{y:n*.8,x:a*m+a*.5,className:M.cx("calendarBottomText"),children:v},v+h.getFullYear())),m===0||h.getFullYear()!==e.dates[m-1].getFullYear()){const P=h.getFullYear().toString();let L;o?L=(6+m+h.getMonth()+1)*a:L=(6+m-h.getMonth())*a,S.push(c.jsx(ye,{value:P,x1Line:a*m,y1Line:0,y2Line:w,xText:L,yText:w*.9},P))}}return[S,N]},V=()=>{const S=[],N=[];let w=1;const m=n*.5,h=e.dates;for(let v=h.length-1;v>=0;v--){const P=h[v];let L="";(v===0||P.getMonth()!==h[v-1].getMonth())&&(L=`${Fe(P,t)}, ${P.getFullYear()}`);const W=`W${Sr(P)}`;N.push(c.jsx("text",{y:n*.8,x:a*(v+ +o),className:M.cx("calendarBottomText"),children:W},P.getTime())),L&&(v!==h.length-1&&S.push(c.jsx(ye,{value:L,x1Line:a*v+w*a,y1Line:0,y2Line:m,xText:a*v+a*w*.5,yText:m*.9},L)),w=0),w++}return[S,N]},T=()=>{const S=[],N=[],w=n*.5,m=e.dates;for(let h=0;h<m.length;h++){const v=m[h],P=`${v.getDate().toString()}`;if(N.push(c.jsx("text",{y:n*.8,x:a*h+a*.5,className:M.cx("calendarBottomText"),children:P},v.getTime())),h+1!==m.length&&v.getMonth()!==m[h+1].getMonth()){const L=Fe(v,t);S.push(c.jsx(ye,{value:L,x1Line:a*(h+1),y1Line:0,y2Line:w,xText:a*(h+1)-wr(v.getMonth(),v.getFullYear())*a*.5,yText:w*.9},L+v.getFullYear()))}}return[S,N]},b=()=>{const S=[],N=[],w=r===z.HalfDay?2:4,m=n*.5,h=e.dates;for(let v=0;v<h.length;v++){const P=h[v],L=Ge(t,{hour:"numeric"}).format(P).replace("时","");if(N.push(c.jsx("text",{y:n*.8,x:a*(v+ +o),className:M.cx("calendarBottomText"),fontFamily:i,children:L},P.getTime())),v===0||P.getDate()!==h[v-1].getDate()){const W=`${Tt(P,t,"short")}, ${P.getDate()} ${Fe(P,t)}`;S.push(c.jsx(ye,{value:W,x1Line:a*v+w*a,y1Line:0,y2Line:m,xText:a*v+w*a*.5,yText:m*.9},W+P.getFullYear()))}}return[S,N]},A=()=>{var h;const S=[],N=[],w=n*.5,m=e.dates;for(let v=0;v<m.length;v++){const P=m[v],L=(h=Ge(t,{hour:"numeric"}).format(P))==null?void 0:h.replace("时","");if(N.push(c.jsx("text",{y:n*.8,x:a*(v+ +o),className:M.cx("calendarBottomText"),fontFamily:i,children:L},P.getTime())),v!==0&&P.getDate()!==m[v-1].getDate()){const W=m[v-1],ve=`${Tt(W,t,"long")}, ${W.getDate()} ${Fe(W,t)}`,Z=(P.getHours()-24)/2;S.push(c.jsx(ye,{value:ve,x1Line:a*v,y1Line:0,y2Line:w,xText:a*(v+Z),yText:w*.9},ve+W.getFullYear()))}}return[S,N]};let p=[],x=[];switch(e.viewMode){case z.Year:[p,x]=u();break;case z.QuarterYear:[p,x]=f();break;case z.Month:[p,x]=y();break;case z.Week:[p,x]=V();break;case z.Day:[p,x]=T();break;case z.QuarterDay:case z.HalfDay:[p,x]=b();break;case z.Hour:[p,x]=A()}return c.jsxs("g",{className:l.nbGanttCalendar,fontSize:s,fontFamily:i,children:[c.jsx("rect",{x:0,y:0,width:a*e.dates.length,height:n,className:l.calendarheader}),x," ",p]})},qr=Ee.createStyles(({token:e,css:t})=>({gridRow:t`
      fill: ${e.colorBgContainer};
    `,gridHeightRow:t`
      fill: #e6f7ff;
      border-color: ${e.colorBorder};
    `,nbGridbody:t`
      .gridrowline: {
        stroke: ${e.colorBorderSecondary};
        stroke-width: 0;
        border-bottom: 1px solid ${e.colorBorderSecondary};
      }
      .gridtick: {
        stroke: ${e.colorBorderSecondary};
      }
    `})),_r=[{id:ze.uid()},{id:ze.uid()},{id:ze.uid()}],Ur=({tasks:e,dates:t,rowHeight:r,svgWidth:o,columnWidth:n,todayColor:a,rtl:i,selectedRowKeys:s})=>{const{styles:l}=qr(),u=e.length?e:_r;let f=0;const y=[],V=[c.jsx("line",{x:"0",y1:0,x2:o,y2:0,className:M.cx("gridRowLine")},"RowLineFirst")];for(const x of u)y.push(c.jsx("rect",{x:"0",y:f,width:o,height:r,className:s!=null&&s.includes(+x.id)?l.gridHeightRow:l.gridRow},"Row"+x.id)),V.push(c.jsx("line",{x:"0",y1:f+r,x2:o,y2:f+r,className:M.cx("gridRowLine")},"RowLine"+x.id)),f+=r;const T=new Date;let b=0;const A=[];let p=c.jsx("rect",{});for(let x=0;x<t.length;x++){const S=t[x];A.push(c.jsx("line",{x1:b,y1:0,x2:b,y2:f,className:M.cx("gridTick")},S.getTime())),(x+1!==t.length&&S.getTime()<T.getTime()&&t[x+1].getTime()>=T.getTime()||x!==0&&x+1===t.length&&S.getTime()<T.getTime()&&H(S,S.getTime()-t[x-1].getTime(),"millisecond").getTime()>=T.getTime())&&(p=c.jsx("rect",{x:b,y:0,width:n,height:f,fill:a})),i&&x+1!==t.length&&S.getTime()>=T.getTime()&&t[x+1].getTime()<T.getTime()&&(p=c.jsx("rect",{x:b+n,y:0,width:n,height:f,fill:a})),b+=n}return c.jsxs("g",{className:M.cx("gridBody",l.nbGridbody),children:[c.jsx("g",{className:"rows",children:y}),c.jsx("g",{className:"rowLines",children:V}),c.jsx("g",{className:"ticks",children:A}),c.jsx("g",{className:"today",children:p})]})},Wr=e=>c.jsx("g",{className:"grid",children:c.jsx(Ur,X({},e))}),Qr=({taskFrom:e,taskTo:t,rowHeight:r,taskHeight:o,arrowIndent:n,rtl:a})=>{let i,s;return a?[i,s]=Jr(e,t,r,o,n):[i,s]=Kr(e,t,r,o,n),c.jsxs("g",{className:"arrow",children:[c.jsx("path",{strokeWidth:"1.5",d:i,fill:"none"}),c.jsx("polygon",{points:s})]})},Kr=(e,t,r,o,n)=>{const a=e.index>t.index?-1:1,i=t.y+o/2,s=e.x2+n*2,l=s<t.x1?"":`H ${t.x1-n}`,u=s>t.x1?n:t.x1-e.x2-n,f=`M ${e.x2} ${e.y+o/2} 
  h ${n} 
  v ${a*r/2} 
  ${l}
  V ${i} 
  h ${u}`,y=`${t.x1},${i} 
  ${t.x1-5},${i-5} 
  ${t.x1-5},${i+5}`;return[f,y]},Jr=(e,t,r,o,n)=>{const a=e.index>t.index?-1:1,i=t.y+o/2,s=e.x1-n*2,l=s>t.x2?"":`H ${t.x2+n}`,u=s<t.x2?-n:t.x2-e.x1+n,f=`M ${e.x1} ${e.y+o/2} 
  h ${-n} 
  v ${a*r/2} 
  ${l}
  V ${i} 
  h ${u}`,y=`${t.x2},${i} 
  ${t.x2+5},${i+5} 
  ${t.x2+5},${i-5}`;return[f,y]},$t=({x:e,y:t,width:r,height:o,barCornerRadius:n,onMouseDown:a})=>c.jsx("rect",{x:e,y:t,width:r,height:o,className:"barHandle",role:"button",ry:n,rx:n,onMouseDown:a}),Vt=M.css`
  cursor: pointer;
  outline: none;
  .barHandle {
    fill: #ddd;
    cursor: ew-resize;
    opacity: 0;
    // visibility: hidden;
  }
  &:hover .barHandle {
    visibility: visible;
    opacity: 1;
  }
`,Zr=M.css`
  user-select: none;
  stroke-width: 0;
  opacity: 0.6;
`,It=({x:e,y:t,color:r,width:o,height:n,isSelected:a,progressX:i,progressWidth:s,barCornerRadius:l,styles:u,onMouseDown:f})=>{const y=()=>r||(a?u.progressSelectedColor:u.progressColor),V=()=>r||(a?u.backgroundSelectedColor:u.backgroundColor);return c.jsxs("g",{onMouseDown:f,children:[c.jsx("rect",{x:e,width:o,y:t,height:n,ry:l,rx:l,fill:V(),className:M.cx(Zr)}),c.jsx("rect",{x:i,width:s,y:t,height:n,ry:l,rx:l,fill:y()})]})},Lt=({progressPoint:e,onMouseDown:t})=>c.jsx("polygon",{className:"barHandle",points:e,onMouseDown:t}),Rr=({task:e,isProgressChangeable:t,isDateChangeable:r,rtl:o,onEventStart:n,isSelected:a})=>{const i=xt(+!o*e.progressWidth+e.progressX,e.y,e.height),s=e.height-2;return c.jsxs("g",{className:M.cx(Vt),"aria-label":"task-bar",tabIndex:0,children:[c.jsx(It,{x:e.x1,y:e.y,color:e.color,width:e.x2-e.x1,height:e.height,progressX:e.progressX,progressWidth:e.progressWidth,barCornerRadius:e.barCornerRadius,styles:e.styles,isSelected:a,onMouseDown:l=>{r&&n("move",e,l)}}),c.jsxs("g",{className:"handleGroup",children:[r&&c.jsxs("g",{children:[c.jsx($t,{x:e.x1+1,y:e.y+1,width:e.handleWidth,height:s,barCornerRadius:e.barCornerRadius,onMouseDown:l=>{n("start",e,l)}}),c.jsx($t,{x:e.x2-e.handleWidth-1,y:e.y+1,width:e.handleWidth,height:s,barCornerRadius:e.barCornerRadius,onMouseDown:l=>{n("end",e,l)}})]}),t&&c.jsx(Lt,{progressPoint:i,onMouseDown:l=>{n("progress",e,l)}})]})]})},eo=({task:e,isProgressChangeable:t,isDateChangeable:r,onEventStart:o,isSelected:n})=>{const a=xt(e.progressWidth+e.x1+10,e.y,e.height);return c.jsxs("g",{className:M.cx(Vt),tabIndex:0,children:[c.jsx(It,{x:e.x1,y:e.y,width:e.x2-e.x1,height:e.height,progressX:e.progressX,progressWidth:e.progressWidth,barCornerRadius:e.barCornerRadius,styles:e.styles,isSelected:n,onMouseDown:i=>{r&&o("move",e,i)}}),c.jsx("g",{className:"handleGroup",children:t&&c.jsx(Lt,{progressPoint:a,onMouseDown:i=>{o("progress",e,i)}})})]})},to=M.css`
  cursor: pointer;
  outline: none;
`,ro=M.css`
  user-select: none;
`,oo=({task:e,isDateChangeable:t,onEventStart:r,isSelected:o})=>{const n=`rotate(45 ${e.x1+e.height*.356} 
    ${e.y+e.height*.85})`,a=()=>o?e.styles.backgroundSelectedColor:e.styles.backgroundColor;return c.jsx("g",{tabIndex:0,className:M.cx(to),children:c.jsx("rect",{fill:a(),x:e.x1,width:e.height,y:e.y,height:e.height,rx:e.barCornerRadius,ry:e.barCornerRadius,transform:n,className:M.cx(ro),onMouseDown:i=>{t&&r("move",e,i)}})})},no=M.css`
  cursor: pointer;
  outline: none;
`,ao=M.css`
  user-select: none;
  opacity: 0.6;
`;M.css`
  user-select: none;
`;const so=({task:e,isSelected:t})=>{const r=t?e.styles.backgroundSelectedColor:e.styles.backgroundColor,o=t?e.styles.progressSelectedColor:e.styles.progressColor,n=e.x2-e.x1;return c.jsxs("g",{tabIndex:0,className:M.cx(no),children:[c.jsx("rect",{fill:e.color||r,x:e.x1,width:n,y:e.y,height:e.height,rx:e.barCornerRadius,ry:e.barCornerRadius,className:M.cx(ao)}),c.jsx("rect",{x:e.progressX,width:e.progressWidth,y:e.y,height:e.height,ry:e.barCornerRadius,rx:e.barCornerRadius,fill:e.color||o})]})},io=Ee.createStyles(({token:e,css:t})=>({nbganttTaskitem:t`
      .barLabel: {
        fill: ${e.colorTextLightSolid},
        textAnchor: middle,
        font-weight: 400,
        dominantBaseline: central,
        WebkitTouchCallout: none,
        WebkitUserSelect: none,
        MozUserSelect: none,
        msUserSelect: none,
        userSelect: none,
        pointerEvents: none,
      },
      .projectLabel: {
        fill: #130d0d,
        fontWeight: 500,
        fontSize: 0.9em,
        dominantBaseline: central,
        WebkitTouchCallout: none,
        WebkitUserSelect: none,
        MozUserSelect: none,
        msUserSelect: none,
        userSelect: none,
        pointerEvents: none,
      },
      .barLabelOutside: {
        fill: ${e.colorTextLabel},
        textAnchor: start,
        WebkitTouchCallout: none,
        WebkitUserSelect: none,
        MozUserSelect: none,
        msUserSelect: none,
        userSelect: none,
        pointerEvents: none,
      },
    }
  }`})),lo=e=>{const{styles:t}=io(),{task:r,arrowIndent:o,isDelete:n,taskHeight:a,isSelected:i,rtl:s,onEventStart:l}=X({},e),u=g.useRef(null),[f,y]=g.useState(c.jsx("div",{})),[V,T]=g.useState(!0),b=r.typeInternal==="project";g.useEffect(()=>{switch(r.typeInternal){case"milestone":y(c.jsx(oo,X({},e)));break;case"project":y(c.jsx(so,X({},e)));break;case"smalltask":y(c.jsx(eo,X({},e)));break;default:y(c.jsx(Rr,X({},e)));break}},[r,i]),g.useEffect(()=>{u.current&&T(u.current.getBBox().width<r.x2-r.x1)},[u,r]);const A=()=>{const p=r.x2-r.x1,x=r.barChildren.length>0;return V?r.x1+p*.5:s&&u.current?r.x1-u.current.getBBox().width-o*+x-o*.2:r.x1+p+o*+x+o*.2};return c.jsxs("g",{className:M.cx(t.nbganttTaskitem),onKeyDown:p=>{switch(p.key){case"Delete":{n&&l("delete",r,p);break}}p.stopPropagation()},onMouseEnter:p=>{l("mouseenter",r,p)},onMouseLeave:p=>{l("mouseleave",r,p)},onDoubleClick:p=>{l("dblclick",r,p)},onClick:p=>{l("click",r,p)},onFocus:()=>{l("select",r)},children:[f,c.jsx("text",{x:b?r.x1:A(),y:b?r.y-8:r.y+a*.65,className:b?M.cx("projectLabel"):V?M.cx("barLabel"):M.cx("barLabelOutside"),ref:u,children:b&&Ce(r.start)&&Ce(r.end)?`${r.name}:  ${Ce(r.start)} ~ ${Ce(r.end)}`:r.name})]})};let at=null,Ae=null;const co=({tasks:e,dates:t,ganttEvent:r,selectedTask:o,rowHeight:n,columnWidth:a,timeStep:i,svg:s,taskHeight:l,arrowColor:u,arrowIndent:f,fontFamily:y,fontSize:V,rtl:T,setGanttEvent:b,setFailedTask:A,setSelectedTask:p,onDateChange:x,onProgressChange:S,onDoubleClick:N,onClick:w,onDelete:m})=>{var je;const h=(je=s==null?void 0:s.current)==null?void 0:je.createSVGPoint(),[v,P]=g.useState(0),[L,W]=g.useState(0),[ve,Z]=g.useState(!1);g.useEffect(()=>{var G,q,O,le;const B=((G=t[1])==null?void 0:G.getTime())-((q=t[0])==null?void 0:q.getTime())-((O=t[1])==null?void 0:O.getTimezoneOffset())*60*1e3+((le=t[0])==null?void 0:le.getTimezoneOffset())*60*1e3,E=i*a/B;P(E)},[a,t,i]),g.useEffect(()=>{const B=G=>ae(this,null,function*(){var Ne;if(!r.changedTask||!h||!(s!=null&&s.current))return;G.preventDefault(),h.x=G.clientX;const q=h.matrixTransform((Ne=s==null?void 0:s.current.getScreenCTM())==null?void 0:Ne.inverse()),{isChanged:O,changedTask:le}=vt(q.x,r.action,r.changedTask,v,i,L,T);O&&b({action:r.action,changedTask:le})}),E=G=>ae(this,null,function*(){var qe;const{action:q,originalSelectedTask:O,changedTask:le}=r;if(!le||!h||!(s!=null&&s.current)||!O)return;G.preventDefault(),h.x=G.clientX;const Ne=h.matrixTransform((qe=s==null?void 0:s.current.getScreenCTM())==null?void 0:qe.inverse()),{changedTask:U}=vt(Ne.x,q,le,v,i,L,T),_=O.start!==U.start||O.end!==U.end||O.progress!==U.progress;s.current.removeEventListener("mousemove",B),s.current.removeEventListener("mouseup",E),b({action:""}),Z(!1);let ce=!0;if((q==="move"||q==="end"||q==="start")&&x&&_)try{const re=yield x(U,U.barChildren);re!==void 0&&(ce=re)}catch(re){ce=!1}else if(S&&_)try{const re=yield S(U,U.barChildren);re!==void 0&&(ce=re)}catch(re){ce=!1}ce||A(O)});!ve&&(r.action==="move"||r.action==="end"||r.action==="start"||r.action==="progress")&&(s!=null&&s.current)&&(s.current.addEventListener("mousemove",B),s.current.addEventListener("mouseup",E),Z(!0))},[r,v,L,S,i,x,s,ve,h,T,A,b]);const $e=(B,E,G)=>ae(this,null,function*(){var q;if(!G)B==="select"&&p(E.id);else if(Cr(G)){if(B==="delete"&&m)try{const O=yield m(E);O!==void 0&&O&&b({action:B,changedTask:E})}catch(O){ze.captureException(O)}}else if(B==="mouseenter")r.action||b({action:B,changedTask:E,originalSelectedTask:E});else if(B==="mouseleave")r.action==="mouseenter"&&setTimeout(()=>{b({action:""})},300);else if(B==="dblclick")N&&N(E);else if(B==="click")G.target.tagName==="rect"&&w&&w(E);else if(B==="move"){if(!(s!=null&&s.current)||!h)return;h.x=G.clientX;const O=h.matrixTransform((q=s.current.getScreenCTM())==null?void 0:q.inverse());W(O.x-E.x1),b({action:B,changedTask:E,originalSelectedTask:E})}else b({action:B,changedTask:E,originalSelectedTask:E})}),st=(B,E,G)=>{["click"].includes(B)?(!["start","end","progress"].includes(at)&&(!Ae||Ae===E.start)&&$e(B,E,G),at=null,Ae=null):["move","select"].includes(B)?(Ae=E.start,$e(B,E,G)):(Ae=E.start,at=B,$e(B,E,G))};return c.jsxs("g",{className:"content",children:[c.jsx("g",{className:"arrows",fill:u,stroke:u,children:e.map(B=>B.barChildren.map(E=>c.jsx(Qr,{taskFrom:B,taskTo:e[E.index],rowHeight:n,taskHeight:l,arrowIndent:f,rtl:T},`Arrow from ${B.id} to ${e[E.index].id}`)))}),c.jsx("g",{className:"bar",fontFamily:y,fontSize:V,children:e.map(B=>c.jsx(lo,{task:B,arrowIndent:f,taskHeight:l,isProgressChangeable:!!S&&!B.isDisabled,isDateChangeable:!!x&&!B.isDisabled,isDelete:!B.isDisabled,onEventStart:st,isSelected:!!o&&B.id===o.id,rtl:T},B.id))})]})},kt=g.forwardRef(({gridProps:e,calendarProps:t,barProps:r,ganttHeight:o,scrollY:n,scrollX:a},i)=>{const s=g.useRef(null),l=g.useRef(null),u=we(X({},r),{svg:s}),{styles:f}=Mt();return g.useEffect(()=>{l.current&&(l.current.scrollTop=n)},[n]),g.useEffect(()=>{i.current&&(i.current.scrollLeft=a)},[a]),c.jsxs("div",{className:f.ganttverticalcontainer,ref:i,dir:"ltr",children:[c.jsx("svg",{xmlns:"http://www.w3.org/2000/svg",width:e.svgWidth,height:t.headerHeight,fontFamily:r.fontFamily,className:"ganttHeader",children:c.jsx(jr,X({},t))}),c.jsx("div",{ref:l,className:f.horizontalcontainer,style:o?{maxHeight:o,width:e.svgWidth}:{width:e.svgWidth},children:c.jsxs("svg",{xmlns:"http://www.w3.org/2000/svg",width:e.svgWidth,height:r.rowHeight*(r.tasks.length||3),fontFamily:r.fontFamily,ref:s,className:"ganttBody",children:[c.jsx(Wr,X({},e)),c.jsx(co,X({},u))]})})]})});kt.displayName="TaskGantt";const uo=(e,t)=>t/e>50?Math.floor(t/e)+20:50,po=g.createContext({close:()=>{}}),ho=e=>{const{visible:t,setVisible:r,record:o}=e;me.useTranslation(),d.useCollection();const n=d.useCollectionParentRecordData(),i=F.useFieldSchema().properties.detail,s=g.useCallback(()=>{r(!1)},[]);return i&&c.jsx(po.Provider,{value:{close:s},children:c.jsx(d.ActionContextProvider,{value:{visible:t,setVisible:r},children:c.jsx(d.RecordProvider,{record:o,parent:n,children:c.jsx(d.VariablePopupRecordProvider,{children:c.jsx(F.RecursionField,{schema:i,name:i.name})})})})})},fo=ht.debounce((e,t,r,o,n)=>ae(this,null,function*(){yield t.update({filterByTk:e.id,values:{[r.start]:e.start,[r.end]:e.end}}),Je.message.success(n("Saved successfully")),yield o==null?void 0:o.refresh()}),300),go=ht.debounce((e,t,r,o,n)=>ae(this,null,function*(){yield t.update({filterByTk:e.id,values:{[r.progress]:e.progress/100}}),Je.message.success(n("Saved successfully")),yield o==null?void 0:o.refresh()}),300),Te=d.withDynamicSchemaProps(e=>{var Kt,Jt,Zt;const{styles:t}=Mt(),{token:r}=d.useToken(),o=d.useAPIClient(),n=(Kt=JSON.parse(o.auth.getOption("theme")))==null?void 0:Kt.uid,{listCellWidth:a="155px",ganttHeight:i=0,preStepsCount:s=1,barFill:l=60,barCornerRadius:u=r.borderRadiusXS,barProgressColor:f=r.colorPrimary,barProgressSelectedColor:y=r.colorPrimary,barBackgroundColor:V=r.colorPrimary,barBackgroundSelectedColor:T=r.colorPrimary,projectProgressColor:b=r.colorPrimary,projectProgressSelectedColor:A=r.colorPrimary,projectBackgroundColor:p=r.colorPrimary,projectBackgroundSelectedColor:x=r.colorPrimary,milestoneBackgroundColor:S="#f1c453",milestoneBackgroundSelectedColor:N="#f29e4c",rtl:w=!1,handleWidth:m=8,timeStep:h=3e5,arrowColor:v="grey",fontFamily:P="-apple-system, BlinkMacSystemFont, 'Segoe UI', Roboto, 'Helvetica Neue', Arial, 'Noto Sans', sans-serif, 'Apple Color Emoji', 'Segoe UI Emoji', 'Segoe UI Symbol', 'Noto Color Emoji'",fontSize:L=r.fontSize,arrowIndent:W=20,todayColor:ve="rgba(252, 248, 227, 0.5)",viewDate:Z,TooltipContent:$e=Pr,onDoubleClick:st,onDelete:je,onSelect:B,onExpanderClick:E,tasks:G,expandAndCollapseAll:q,fieldNames:O,loading:le}=d.useProps(e),{designable:Ne}=d.useDesignable(),U=n!=null&&n.includes("compact")?45:Ne?65:55,_=n!=null&&n.includes("compact")?45:65,ce=J(),qe=d.useCurrentAppInfo(),{t:re}=me.useTranslation(),mo=(Jt=qe.data)==null?void 0:Jt.lang,it=d.useTableBlockContext(),{resource:Ht,service:Ve}=d.useBlockRequestContext(),Gt=F.useFieldSchema(),oe=O.range||"day",Se=g.useRef(null),lt=g.useRef(null),Ot=g.useRef(null),[de,bo]=g.useState(()=>{const[C,k]=wt(G,oe,s);return{viewMode:oe,dates:Ct(C,k,oe)}}),[xo,Xt]=g.useState(!1),[yo,vo]=g.useState({}),[Ie,Yt]=g.useState(void 0),[_e,jt]=g.useState(0),[So,wo]=g.useState(0),[Co,qt]=g.useState(i),[ne,Ue]=g.useState([]),[Le,_t]=g.useState({action:""}),ct=g.useMemo(()=>_*l/100,[_,l]),[dt,To]=g.useState(),[We,Ut]=g.useState(null),[ge,ut]=g.useState(0),[ue,ke]=g.useState(-1),[Wt,Me]=g.useState(!1),ee=uo(de.dates.length,(Zt=Ot.current)==null?void 0:Zt.clientWidth),pe=de.dates.length*ee,De=ne.length*_,{expandFlag:Qt}=it,[No,Mo]=g.useState([]);g.useEffect(()=>{it.field.onExpandClick=Ao,it.field.onRowSelect=$o},[]),g.useEffect(()=>{q==null||q(!Qt)},[Qt]),g.useEffect(()=>{let C;E?C=Tr(G):C=G,C=C.sort(Nr);const[k,D]=wt(C,oe,s);let $=Ct(k,D,oe);w&&($=$.reverse(),ue===-1&&ke($.length*ee)),bo({dates:$,viewMode:oe}),Ue(ur(C,$,ee,_,ct,u,m,w,f,y,V,T,b,A,p,x,S,N))},[G,oe,s,_,u,ee,ct,m,f,y,V,T,b,A,p,x,S,N,w,ue]),g.useEffect(()=>{if(oe===de.viewMode&&(Z&&!Ie||Z&&(Ie==null?void 0:Ie.valueOf())!==Z.valueOf())){const C=de.dates,k=C.findIndex((D,$)=>Z.valueOf()>=D.valueOf()&&$+1!==C.length&&Z.valueOf()<C[$+1].valueOf());if(k===-1)return;Yt(Z),ke(ee*k)}},[Z,ee,de.dates,de.viewMode,oe,Ie,Yt]),g.useEffect(()=>{const{changedTask:C,action:k}=Le;if(C){if(k==="delete")_t({action:""}),Ue(ne.filter(D=>D.id!==C.id));else if(k==="move"||k==="end"||k==="start"||k==="progress"){const D=ne.find($=>$.id===C.id);if(D&&D.start&&D.end&&(D.start.getTime()!==C.start.getTime()||D.end.getTime()!==C.end.getTime()||D.progress!==C.progress)){const $=ne.map(K=>K.id===C.id?C:K);Ue($)}}}},[Le,ne]),g.useEffect(()=>{We&&(Ue(ne.map(C=>C.id!==We.id?C:We)),Ut(null))},[We,ne]),g.useEffect(()=>{a||jt(0),lt.current&&jt(lt.current.offsetWidth)},[lt,a]),g.useEffect(()=>{Se.current&&wo(Se.current.offsetWidth-_e)},[Se,_e]),g.useEffect(()=>{qt(i?i+U:G.length*_+U)},[i,G,U,_]),g.useEffect(()=>{var k;const C=D=>{if(D.shiftKey||D.deltaX){const $=D.deltaX?D.deltaX:D.deltaY;let K=ue+$;K<0?K=0:K>pe&&(K=pe),ke(K),D.preventDefault()}else if(i){let $=ge+D.deltaY;$<0?$=0:$>De-i&&($=De-i),$!==ge&&(ut($),D.preventDefault())}Me(!0)};return(k=Se.current)==null||k.addEventListener("wheel",C,{passive:!1}),()=>{var D;(D=Se.current)==null||D.removeEventListener("wheel",C)}},[Se,ge,ue,i,pe,w,De]);const Do=C=>{ge!==C.currentTarget.scrollTop&&!Wt?(ut(C.currentTarget.scrollTop),Me(!0)):Me(!1)},Po=C=>{ue!==C.currentTarget.scrollLeft&&!Wt?(ke(C.currentTarget.scrollLeft),Me(!0)):Me(!1)},Bo=C=>{C.preventDefault();let k=ge,D=ue,$=!0;switch(C.key){case"Down":case"ArrowDown":k+=_,$=!1;break;case"Up":case"ArrowUp":k-=_,$=!1;break;case"Left":case"ArrowLeft":D-=ee;break;case"Right":case"ArrowRight":D+=ee;break}$?(D<0?D=0:D>pe&&(D=pe),ke(D)):(k<0?k=0:k>De-i&&(k=De-i),ut(k)),Me(!0)},Fo=C=>{const k=ne.find($=>$.id===C),D=ne.find($=>!!dt&&$.id===dt.id);B&&(D&&B(D,!1),k&&B(k,!0)),To(k)},Ao=(C,k)=>{var $;const D=($=ce==null?void 0:ce.field)==null?void 0:$.data.find(K=>K.id===k.id+"");E&&k.children.length&&E(we(X({},D),{hideChildren:!C}))},$o=C=>{Mo(C)},Vo=C=>ae(this,null,function*(){go(C,Ht,O,Ve,re)}),Io=C=>ae(this,null,function*(){fo(C,Ht,O,Ve,re)}),Lo=C=>{var K;const k=pt=>pt.reduce((Rt,Qe)=>Qe.children?Rt.concat([Qe,...k(Qe.children)]):Rt.concat(Qe),[]),D=k((K=Ve==null?void 0:Ve.data)==null?void 0:K.data),$=D==null?void 0:D.find(pt=>pt.id===+C.id);$&&(vo($),Xt(!0))},ko={columnWidth:ee,svgWidth:pe,tasks:G,rowHeight:_,dates:de.dates,todayColor:ve,rtl:w,selectedRowKeys:No},Eo={dateSetup:de,locale:mo,viewMode:oe,headerHeight:U,columnWidth:ee,fontFamily:P,fontSize:L,rtl:w},zo={tasks:ne,dates:de.dates,ganttEvent:Le,selectedTask:dt,rowHeight:_,taskHeight:ct,columnWidth:ee,arrowColor:v,timeStep:h,fontFamily:P,fontSize:L,arrowIndent:W,svgWidth:pe,rtl:w,setGanttEvent:_t,setFailedTask:Ut,setSelectedTask:Fo,onDateChange:Io,onProgressChange:O.progress&&Vo,onDoubleClick:st,onClick:Lo,onDelete:je};return c.jsxs("div",{className:M.cx(M.css`
        .ant-table-container::after {
          box-shadow: none !important;
        }
        .ant-table-row {
          height: ${_}px;
        }
        .ant-table-thead {
          height: ${U}px;

          tr > th {
            padding-top: 0;
            padding-bottom: 0;
          }
        }
        .ant-table {
          border-top-right-radius: 0;
        }
        .ant-table-container table > thead > tr:first-child > *:last-child {
          border-start-end-radius: 0;
        }
        .ant-table-wrapper {
          box-shadow: none;
        }

        .ant-table-content {
          &::-webkit-scrollbar {
            width: 8px;
            height: 8px;
          }

          &:hover::-webkit-scrollbar,
          &:active::-webkit-scrollbar {
            width: 8px;
            height: 8px;
          }
        }
      `),children:[c.jsx(ho,{visible:xo,setVisible:Xt,record:yo}),c.jsx(F.RecursionField,{name:"anctionBar",schema:Gt.properties.toolBar}),c.jsx(F.RecursionField,{name:"table",schema:Gt.properties.table}),c.jsxs("div",{className:t.wrapper,onKeyDown:Bo,tabIndex:0,ref:Se,children:[c.jsx(kt,{gridProps:ko,calendarProps:Eo,barProps:zo,ganttHeight:i,scrollY:ge,scrollX:ue,ref:Ot}),Le.changedTask&&c.jsx(Dr,{arrowIndent:W,rowHeight:_,svgContainerHeight:Co,svgContainerWidth:So,fontFamily:P,fontSize:L,scrollX:ue,scrollY:ge,task:Le.changedTask,headerHeight:U,taskListWidth:_e,TooltipContent:$e,rtl:w,svgWidth:pe}),c.jsx(Br,{ganttFullHeight:De,ganttHeight:i,headerHeight:U,scroll:ge,onScroll:Do,rtl:w}),c.jsx(Je.Spin,{spinning:le,style:{visibility:"hidden"},children:c.jsx(Mr,{svgWidth:pe,taskListWidth:_e,scroll:ue,rtl:w,onScroll:Po})})]})]})});Te.ActionBar=d.ActionBar,Te.ViewMode=z,Te.Designer=rr,Te.Event=dr;const Et=g.memo(e=>c.jsx(d.SchemaComponentOptions,{components:{Gantt:Te,GanttBlockInitializer:cr,GanttBlockProvider:nr},scope:{useGanttBlockProps:ft},children:e.children}));Et.displayName="GanttProvider";class zt extends d.Plugin{load(){return ae(this,null,function*(){this.app.use(Et),this.app.schemaSettingsManager.add(ar),this.app.schemaSettingsManager.add(sr),this.app.schemaInitializerManager.add(gt),this.app.schemaInitializerManager.add(ir);const t=this.app.schemaInitializerManager.get("page:addBlock");t==null||t.add("dataBlocks.gantt",{title:"{{t('Gantt')}}",Component:"GanttBlockInitializer"}),this.app.addScopes({useGanttBlockProps:ft})})}}I.Gantt=Te,I.PluginGanttClient=zt,I.default=zt,Object.defineProperties(I,{__esModule:{value:!0},[Symbol.toStringTag]:{value:"Module"}})});
