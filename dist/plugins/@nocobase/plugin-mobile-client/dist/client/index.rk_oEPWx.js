(function(){"use strict";try{if(typeof document!="undefined"){var a=document.createElement("style");a.id="@nocobase/plugin-mobile-client",a.appendChild(document.createTextNode(':root{--adm-radius-s: 4px;--adm-radius-m: 8px;--adm-radius-l: 12px;--adm-font-size-1: 9px;--adm-font-size-2: 10px;--adm-font-size-3: 11px;--adm-font-size-4: 12px;--adm-font-size-5: 13px;--adm-font-size-6: 14px;--adm-font-size-7: 15px;--adm-font-size-8: 16px;--adm-font-size-9: 17px;--adm-font-size-10: 18px;--adm-color-primary: #1677ff;--adm-color-success: #00b578;--adm-color-warning: #ff8f1f;--adm-color-danger: #ff3141;--adm-color-yellow: #ff9f18;--adm-color-orange: #ff6430;--adm-color-wathet: #e7f1ff;--adm-color-text: #333333;--adm-color-text-secondary: #666666;--adm-color-weak: #999999;--adm-color-light: #cccccc;--adm-color-border: #eeeeee;--adm-color-background: #ffffff;--adm-color-highlight: var(--adm-color-danger);--adm-color-white: #ffffff;--adm-color-box: #f5f5f5;--adm-color-text-light-solid: var(--adm-color-white);--adm-color-text-dark-solid: #000000;--adm-color-fill-content: var(--adm-color-box);--adm-font-size-main: var(--adm-font-size-5);--adm-font-family: -apple-system, blinkmacsystemfont, "Helvetica Neue", helvetica, segoe ui, arial, roboto, "PingFang SC", "miui", "Hiragino Sans GB", "Microsoft Yahei", sans-serif;--adm-border-color: var(--adm-color-border)}html[data-prefers-color-scheme=dark]{--adm-color-primary: #3086ff;--adm-color-success: #34b368;--adm-color-warning: #ffa930;--adm-color-danger: #ff4a58;--adm-color-yellow: #ffa930;--adm-color-orange: #e65a2b;--adm-color-wathet: #0d2543;--adm-color-text: #e6e6e6;--adm-color-text-secondary: #b3b3b3;--adm-color-weak: #808080;--adm-color-light: #4d4d4d;--adm-color-border: #2b2b2b;--adm-color-box: #0a0a0a;--adm-color-background: #1a1a1a;--adm-color-background-body: var(--adm-color-background);--adm-border-color: var(--adm-color-border)}:root{-webkit-tap-highlight-color:rgba(0,0,0,0)}html{background-color:var(--adm-color-background-body)}body{color:var(--adm-color-text);font-size:var(--adm-font-size-main);font-family:var(--adm-font-family)}a,button{cursor:pointer}a{color:var(--adm-color-primary);transition:opacity ease-in-out .2s}a:active{opacity:.8}.adm-plain-anchor{color:unset;transition:none}.adm-plain-anchor:active{opacity:unset}body.adm-overflow-hidden{overflow:hidden!important}div.adm-px-tester{--size: 1;height:calc(var(--size) / 2 * 2px);width:0;position:fixed;right:-100vw;bottom:-100vh;-webkit-user-select:none;user-select:none;pointer-events:none}.adm-safe-area{--multiple: var(--adm-safe-area-multiple, 1);display:block;width:100%}.adm-safe-area-position-top{padding-top:calc(env(safe-area-inset-top) * var(--multiple))}.adm-safe-area-position-bottom{padding-bottom:calc(env(safe-area-inset-bottom) * var(--multiple))}.adm-badge-wrapper{display:inline-block;position:relative}.adm-badge{display:inline-flex;vertical-align:middle;box-sizing:content-box;border-radius:100px;background-color:var(--color);--right: 0;--top: 0;--color: var(--adm-badge-color, var(--adm-color-highlight))}.adm-badge-content{color:var(--adm-color-text-light-solid);box-sizing:border-box;min-width:8px;padding:1px 4px;font-size:var(--adm-font-size-1);line-height:12px;white-space:nowrap;font-weight:400;text-align:center}.adm-badge-fixed{position:absolute;right:var(--right);top:var(--top);transform:translate(50%,-50%)}.adm-badge-dot{min-width:10px;width:10px;height:10px;border-radius:5px}.adm-badge-bordered{border:solid 1px var(--adm-color-text-light-solid)}.adm-list{--header-font-size: var(--adm-font-size-7);--prefix-width: "auto";--prefix-padding-right: 12px;--align-items: center;--active-background-color: var(--adm-color-border);--border-inner: solid 1px var(--adm-color-border);--border-top: solid 1px var(--adm-color-border);--border-bottom: solid 1px var(--adm-color-border);--padding-left: 12px;--padding-right: 12px;--font-size: var(--adm-font-size-9);--extra-max-width: 70%}.adm-list-header{color:var(--adm-color-weak);font-size:var(--header-font-size);padding:8px var(--padding-right) 8px var(--padding-left)}.adm-list-body{background-color:var(--adm-color-background);overflow:hidden;font-size:var(--font-size)}.adm-list-body-inner{margin-top:-1px}.adm-list-default .adm-list-body{border-top:var(--border-top);border-bottom:var(--border-bottom)}.adm-list-card{margin:12px}.adm-list-card .adm-list-body{border-radius:8px}.adm-list-card .adm-list-header{padding-left:0}.adm-list-item{display:block;padding-left:var(--padding-left);position:relative;background-color:var(--adm-color-background);line-height:1.5}.adm-list-item-title,.adm-list-item-description{color:var(--adm-color-weak);font-size:var(--adm-font-size-main)}.adm-list-item-content{display:flex;align-items:var(--align-items);justify-content:flex-start;border-top:var(--border-inner);padding-right:var(--padding-right)}.adm-list-item-content-prefix{width:var(--prefix-width);flex:none;padding-right:var(--prefix-padding-right)}.adm-list-item-content-main{flex:auto;padding:12px 0}.adm-list-item-content-extra{flex:none;padding-left:12px;font-size:var(--adm-font-size-7);color:var(--adm-color-weak);max-width:var(--extra-max-width)}.adm-list-item-content-arrow{flex:none;display:flex;align-items:center;margin-left:4px;color:var(--adm-color-light);font-size:19px}.adm-list-item-disabled{cursor:not-allowed}.adm-list-item-disabled.adm-list-item-disabled>.adm-list-item-content>*{opacity:.4;pointer-events:none}a.adm-list-item:active:not(.adm-list-item-disabled){background-color:var(--active-background-color)}a.adm-list-item:active:not(.adm-list-item-disabled):after{content:" ";display:block;position:absolute;width:100%;bottom:-1px;left:0;border-bottom:var(--border-inner)}.adm-nav-bar{--height: 45px;--border-bottom: none;display:flex;align-items:center;height:var(--height);border-bottom:var(--border-bottom);padding:0 12px;white-space:nowrap}.adm-nav-bar-left,.adm-nav-bar-right{flex:1}.adm-nav-bar-title{flex:auto;text-align:center;overflow:hidden;text-overflow:ellipsis}.adm-nav-bar-back{display:flex;align-items:center;margin-right:16px;padding:6px 0;cursor:pointer}.adm-nav-bar-back-arrow{font-size:24px;margin-right:4px}.adm-nav-bar-left{font-size:var(--adm-font-size-7);display:flex;justify-content:flex-start;align-items:center}.adm-nav-bar-title{justify-content:center;white-space:nowrap;font-size:var(--adm-font-size-10);padding:0 12px}.adm-nav-bar-right{text-align:right}.adm-tab-bar-wrap{display:flex;flex-wrap:nowrap;justify-content:flex-start;align-items:stretch;overflow:hidden;min-height:48px}.adm-tab-bar-item{flex:1;color:var(--adm-color-text-secondary);white-space:nowrap;padding:4px 8px;width:-webkit-min-content;width:min-content;position:relative;cursor:pointer;display:flex;align-items:center;justify-content:center;flex-direction:column}.adm-tab-bar-item-icon{font-size:24px;height:24px;line-height:1}.adm-tab-bar-item-title{font-size:var(--adm-font-size-2);line-height:15px}.adm-tab-bar-item-title-with-icon{margin-top:2px}.adm-tab-bar-item-active{color:var(--adm-color-primary)}.adm-tab-bar-icon-badge{--top: 6px}.adm-tab-bar-title-badge{--right: -2px;--top: -2px}')),document.head.appendChild(a)}}catch(o){console.error("vite-plugin-css-injected-by-js",o)}})();
(function(f,r){typeof exports=="object"&&typeof module!="undefined"?r(exports,require("react/jsx-runtime"),require("@nocobase/client"),require("react-router-dom"),require("react"),require("react-i18next"),require("@ant-design/icons"),require("@formily/react"),require("antd"),require("lodash"),require("ahooks"),require("@formily/shared"),require("@formily/antd-v5")):typeof define=="function"&&define.amd?define(["exports","react/jsx-runtime","@nocobase/client","react-router-dom","react","react-i18next","@ant-design/icons","@formily/react","antd","lodash","ahooks","@formily/shared","@formily/antd-v5"],r):(f=typeof globalThis!="undefined"?globalThis:f||self,r(f["@nocobase/plugin-mobile-client"]={},f.jsxRuntime,f["@nocobase/client"],f["react-router-dom"],f.react,f["react-i18next"],f["@ant-design/icons"],f["@formily/react"],f.antd,f.lodash,f.ahooks,f["@formily/shared"],f["@formily/antd-v5"]))})(this,function(f,r,o,y,l,le,j,b,v,q,de,pe,Tt){"use strict";var bi=Object.defineProperty,hi=Object.defineProperties;var vi=Object.getOwnPropertyDescriptors;var wt=Object.getOwnPropertySymbols;var yi=Object.prototype.hasOwnProperty,xi=Object.prototype.propertyIsEnumerable;var Oe=(f,r,o)=>r in f?bi(f,r,{enumerable:!0,configurable:!0,writable:!0,value:o}):f[r]=o,S=(f,r)=>{for(var o in r||(r={}))yi.call(r,o)&&Oe(f,o,r[o]);if(wt)for(var o of wt(r))xi.call(r,o)&&Oe(f,o,r[o]);return f},B=(f,r)=>hi(f,vi(r));var Pt=(f,r,o)=>(Oe(f,typeof r!="symbol"?r+"":r,o),o);var N=(f,r,o)=>new Promise((y,l)=>{var le=v=>{try{b(o.next(v))}catch(q){l(q)}},j=v=>{try{b(o.throw(v))}catch(q){l(q)}},b=v=>v.done?y(v.value):Promise.resolve(v.value).then(le,j);b((o=o.apply(f,r)).next())});function Mt(e){const t=Object.create(null,{[Symbol.toStringTag]:{value:"Module"}});if(e){for(const n in e)if(n!=="default"){const a=Object.getOwnPropertyDescriptor(e,n);Object.defineProperty(t,n,a.get?a:{enumerable:!0,get:()=>e[n]})}}return t.default=e,Object.freeze(t)}const T=Mt(l),Ee=()=>window.JsBridge,kt=(e,t)=>Ee().invoke(e,t),Ot=()=>!!Ee(),Be={onBackPressed:()=>{history.length===1?kt({action:"moveTaskToBack"}):history.back()}};Object.keys(Be).forEach(e=>{window[e]=Be[e]});const Ne=l.memo(e=>{const t=y.useLocation(),n=y.useNavigate();return l.useEffect(()=>{Ot()&&t.pathname==="/app"&&n("/mobile",{replace:!0})},[t.pathname,n]),r.jsx(r.Fragment,{children:e.children})});Ne.displayName="MobileClientProvider";const M="mobile-client";function A(e){return`{{t('${e}', { ns: '${M}', nsMode: 'fallback' })}}`}function I(){return le.useTranslation([M,"client"],{nsMode:"fallback"})}const je={name:"mobilePage:addBlock",title:'{{t("Add block")}}',icon:"PlusOutlined",wrap:o.gridRowColWrap,items:[{name:"dataBlocks",type:"itemGroup",title:'{{t("Data blocks")}}',children:[{name:"gridCard",type:"item",title:'{{t("Grid Card")}}',Component:"GridCardBlockInitializer"},{name:"table",title:'{{t("Table")}}',Component:"TableBlockInitializer"},{name:"form",title:'{{t("Form")}}',Component:"FormBlockInitializer"},{name:"details",title:'{{t("Details")}}',Component:"DetailsBlockInitializer"},{name:"calendar",title:'{{t("Calendar")}}',Component:"CalendarBlockInitializer"},{name:"mapBlock",title:A("Map"),Component:"MapBlockInitializer"},{name:"charts",title:'{{t("Charts")}}',Component:"ChartV2BlockInitializer"}]},{name:"otherBlocks",type:"itemGroup",title:'{{t("Other blocks")}}',children:[{name:"menu",title:A("Menu"),Component:"MMenuBlockInitializer"},{name:"markdown",title:'{{t("Markdown")}}',Component:"MarkdownBlockInitializer"},{name:"settings",title:A("Settings"),Component:"MSettingsBlockInitializer"}]}]},Ae=new o.CompatibleSchemaInitializer(B(S({},je),{name:"MBlockInitializers"})),Et=new o.CompatibleSchemaInitializer(je,Ae),Bt=()=>{const e=o.useSchemaInitializerItem(),{insert:t}=o.useSchemaInitializer();return r.jsx(o.SchemaInitializerItem,S({icon:r.jsx(j.MenuOutlined,{}),onClick:()=>N(this,null,function*(){t({type:"void","x-component":"MMenu","x-designer":"MMenu.Designer","x-component-props":{}})})},e))};!!(typeof window!="undefined"&&typeof document!="undefined"&&window.document&&window.document.createElement)&&document.addEventListener("touchstart",()=>{},!0);function ue(e,t){const n=e;for(const a in t)t.hasOwnProperty(a)&&(n[a]=t[a]);return n}var J=typeof globalThis!="undefined"?globalThis:typeof window!="undefined"?window:typeof global!="undefined"?global:typeof self!="undefined"?self:{};function Fe(e){return e&&e.__esModule&&Object.prototype.hasOwnProperty.call(e,"default")?e.default:e}var _e={exports:{}};/*!
	Copyright (c) 2018 Jed Watson.
	Licensed under the MIT License (MIT), see
	http://jedwatson.github.io/classnames
*/(function(e){(function(){var t={}.hasOwnProperty;function n(){for(var a=[],i=0;i<arguments.length;i++){var c=arguments[i];if(c){var d=typeof c;if(d==="string"||d==="number")a.push(c);else if(Array.isArray(c)){if(c.length){var s=n.apply(null,c);s&&a.push(s)}}else if(d==="object"){if(c.toString!==Object.prototype.toString&&!c.toString.toString().includes("[native code]")){a.push(c.toString());continue}for(var p in c)t.call(c,p)&&c[p]&&a.push(p)}}}return a.join(" ")}e.exports?(n.default=n,e.exports=n):window.classNames=n})()})(_e);var Nt=_e.exports;const k=Fe(Nt);function L(e,t){const n=Object.assign({},t.props);e.className&&(n.className=k(t.props.className,e.className)),e.style&&(n.style=Object.assign(Object.assign({},n.style),e.style)),e.tabIndex!==void 0&&(n.tabIndex=e.tabIndex);for(const a in e)e.hasOwnProperty(a)&&(a.startsWith("data-")||a.startsWith("aria-"))&&(n[a]=e[a]);return l.cloneElement(t,n)}var jt=typeof J=="object"&&J&&J.Object===Object&&J,Le=jt,At=Le,Ft=typeof self=="object"&&self&&self.Object===Object&&self,_t=At||Ft||Function("return this")(),me=_t,Lt=me,Dt=Lt.Symbol,De=Dt,ze=De,Ge=Object.prototype,zt=Ge.hasOwnProperty,Gt=Ge.toString,H=ze?ze.toStringTag:void 0;function Ut(e){var t=zt.call(e,H),n=e[H];try{e[H]=void 0;var a=!0}catch(c){}var i=Gt.call(e);return a&&(t?e[H]=n:delete e[H]),i}var qt=Ut,Ht=Object.prototype,Vt=Ht.toString;function Kt(e){return Vt.call(e)}var Wt=Kt,Ue=De,Jt=qt,Xt=Wt,Zt="[object Null]",Qt="[object Undefined]",qe=Ue?Ue.toStringTag:void 0;function Yt(e){return e==null?e===void 0?Qt:Zt:qe&&qe in Object(e)?Jt(e):Xt(e)}var fe=Yt;function Rt(e){var t=typeof e;return e!=null&&(t=="object"||t=="function")}var ge=Rt,en=fe,tn=ge,nn="[object AsyncFunction]",rn="[object Function]",on="[object GeneratorFunction]",an="[object Proxy]";function sn(e){if(!tn(e))return!1;var t=en(e);return t==rn||t==on||t==nn||t==an}var He=sn,cn=me,ln=cn["__core-js_shared__"],dn=ln,be=dn,Ve=function(){var e=/[^.]+$/.exec(be&&be.keys&&be.keys.IE_PROTO||"");return e?"Symbol(src)_1."+e:""}();function pn(e){return!!Ve&&Ve in e}var un=pn,mn=Function.prototype,fn=mn.toString;function gn(e){if(e!=null){try{return fn.call(e)}catch(t){}try{return e+""}catch(t){}}return""}var bn=gn,hn=He,vn=un,yn=ge,xn=bn,Sn=/[\\^$.*+?()[\]{}|]/g,$n=/^\[object .+?Constructor\]$/,Cn=Function.prototype,In=Object.prototype,wn=Cn.toString,Pn=In.hasOwnProperty,Tn=RegExp("^"+wn.call(Pn).replace(Sn,"\\$&").replace(/hasOwnProperty|(function).*?(?=\\\()| for .+?(?=\\\])/g,"$1.*?")+"$");function Mn(e){if(!yn(e)||vn(e))return!1;var t=hn(e)?Tn:$n;return t.test(xn(e))}var kn=Mn;function On(e,t){return e==null?void 0:e[t]}var En=On,Bn=kn,Nn=En;function jn(e,t){var n=Nn(e,t);return Bn(n)?n:void 0}var An=jn,Fn=An,_n=function(){try{var e=Fn(Object,"defineProperty");return e({},"",{}),e}catch(t){}}(),Ke=_n,We=Ke;function Ln(e,t,n){t=="__proto__"&&We?We(e,t,{configurable:!0,enumerable:!0,value:n,writable:!0}):e[t]=n}var Je=Ln;function Dn(e,t){return e===t||e!==e&&t!==t}var Xe=Dn,zn=Je,Gn=Xe,Un=Object.prototype,qn=Un.hasOwnProperty;function Hn(e,t,n){var a=e[t];(!(qn.call(e,t)&&Gn(a,n))||n===void 0&&!(t in e))&&zn(e,t,n)}var Vn=Hn,Kn=Vn,Wn=Je;function Jn(e,t,n,a){var i=!n;n||(n={});for(var c=-1,d=t.length;++c<d;){var s=t[c],p=a?a(n[s],e[s],s,n,e):void 0;p===void 0&&(p=e[s]),i?Wn(n,s,p):Kn(n,s,p)}return n}var Xn=Jn;function Zn(e){return e}var Ze=Zn;function Qn(e,t,n){switch(n.length){case 0:return e.call(t);case 1:return e.call(t,n[0]);case 2:return e.call(t,n[0],n[1]);case 3:return e.call(t,n[0],n[1],n[2])}return e.apply(t,n)}var Yn=Qn,Rn=Yn,Qe=Math.max;function er(e,t,n){return t=Qe(t===void 0?e.length-1:t,0),function(){for(var a=arguments,i=-1,c=Qe(a.length-t,0),d=Array(c);++i<c;)d[i]=a[t+i];i=-1;for(var s=Array(t+1);++i<t;)s[i]=a[i];return s[t]=n(d),Rn(e,this,s)}}var tr=er;function nr(e){return function(){return e}}var rr=nr,or=rr,Ye=Ke,ar=Ze,ir=Ye?function(e,t){return Ye(e,"toString",{configurable:!0,enumerable:!1,value:or(t),writable:!0})}:ar,sr=ir,cr=800,lr=16,dr=Date.now;function pr(e){var t=0,n=0;return function(){var a=dr(),i=lr-(a-n);if(n=a,i>0){if(++t>=cr)return arguments[0]}else t=0;return e.apply(void 0,arguments)}}var ur=pr,mr=sr,fr=ur,gr=fr(mr),br=gr,hr=Ze,vr=tr,yr=br;function xr(e,t){return yr(vr(e,t,hr),e+"")}var Sr=xr,$r=9007199254740991;function Cr(e){return typeof e=="number"&&e>-1&&e%1==0&&e<=$r}var Re=Cr,Ir=He,wr=Re;function Pr(e){return e!=null&&wr(e.length)&&!Ir(e)}var et=Pr,Tr=9007199254740991,Mr=/^(?:0|[1-9]\d*)$/;function kr(e,t){var n=typeof e;return t=t==null?Tr:t,!!t&&(n=="number"||n!="symbol"&&Mr.test(e))&&e>-1&&e%1==0&&e<t}var tt=kr,Or=Xe,Er=et,Br=tt,Nr=ge;function jr(e,t,n){if(!Nr(n))return!1;var a=typeof t;return(a=="number"?Er(n)&&Br(t,n.length):a=="string"&&t in n)?Or(n[t],e):!1}var Ar=jr,Fr=Sr,_r=Ar;function Lr(e){return Fr(function(t,n){var a=-1,i=n.length,c=i>1?n[i-1]:void 0,d=i>2?n[2]:void 0;for(c=e.length>3&&typeof c=="function"?(i--,c):void 0,d&&_r(n[0],n[1],d)&&(c=i<3?void 0:c,i=1),t=Object(t);++a<i;){var s=n[a];s&&e(t,s,a,c)}return t})}var Dr=Lr;function zr(e,t){for(var n=-1,a=Array(e);++n<e;)a[n]=t(n);return a}var Gr=zr;function Ur(e){return e!=null&&typeof e=="object"}var he=Ur,qr=fe,Hr=he,Vr="[object Arguments]";function Kr(e){return Hr(e)&&qr(e)==Vr}var Wr=Kr,nt=Wr,Jr=he,rt=Object.prototype,Xr=rt.hasOwnProperty,Zr=rt.propertyIsEnumerable,Qr=nt(function(){return arguments}())?nt:function(e){return Jr(e)&&Xr.call(e,"callee")&&!Zr.call(e,"callee")},Yr=Qr,Rr=Array.isArray,eo=Rr,X={exports:{}};function to(){return!1}var no=to;X.exports,function(e,t){var n=me,a=no,i=t&&!t.nodeType&&t,c=i&&!0&&e&&!e.nodeType&&e,d=c&&c.exports===i,s=d?n.Buffer:void 0,p=s?s.isBuffer:void 0,u=p||a;e.exports=u}(X,X.exports);var ro=X.exports,oo=fe,ao=Re,io=he,so="[object Arguments]",co="[object Array]",lo="[object Boolean]",po="[object Date]",uo="[object Error]",mo="[object Function]",fo="[object Map]",go="[object Number]",bo="[object Object]",ho="[object RegExp]",vo="[object Set]",yo="[object String]",xo="[object WeakMap]",So="[object ArrayBuffer]",$o="[object DataView]",Co="[object Float32Array]",Io="[object Float64Array]",wo="[object Int8Array]",Po="[object Int16Array]",To="[object Int32Array]",Mo="[object Uint8Array]",ko="[object Uint8ClampedArray]",Oo="[object Uint16Array]",Eo="[object Uint32Array]",h={};h[Co]=h[Io]=h[wo]=h[Po]=h[To]=h[Mo]=h[ko]=h[Oo]=h[Eo]=!0,h[so]=h[co]=h[So]=h[lo]=h[$o]=h[po]=h[uo]=h[mo]=h[fo]=h[go]=h[bo]=h[ho]=h[vo]=h[yo]=h[xo]=!1;function Bo(e){return io(e)&&ao(e.length)&&!!h[oo(e)]}var No=Bo;function jo(e){return function(t){return e(t)}}var Ao=jo,Z={exports:{}};Z.exports,function(e,t){var n=Le,a=t&&!t.nodeType&&t,i=a&&!0&&e&&!e.nodeType&&e,c=i&&i.exports===a,d=c&&n.process,s=function(){try{var p=i&&i.require&&i.require("util").types;return p||d&&d.binding&&d.binding("util")}catch(u){}}();e.exports=s}(Z,Z.exports);var Fo=Z.exports,_o=No,Lo=Ao,ot=Fo,at=ot&&ot.isTypedArray,Do=at?Lo(at):_o,zo=Do,Go=Gr,Uo=Yr,qo=eo,Ho=ro,Vo=tt,Ko=zo,Wo=Object.prototype,Jo=Wo.hasOwnProperty;function Xo(e,t){var n=qo(e),a=!n&&Uo(e),i=!n&&!a&&Ho(e),c=!n&&!a&&!i&&Ko(e),d=n||a||i||c,s=d?Go(e.length,String):[],p=s.length;for(var u in e)(t||Jo.call(e,u))&&!(d&&(u=="length"||i&&(u=="offset"||u=="parent")||c&&(u=="buffer"||u=="byteLength"||u=="byteOffset")||Vo(u,p)))&&s.push(u);return s}var Zo=Xo,Qo=Object.prototype;function Yo(e){var t=e&&e.constructor,n=typeof t=="function"&&t.prototype||Qo;return e===n}var Ro=Yo;function ea(e,t){return function(n){return e(t(n))}}var ta=ea,na=ta,ra=na(Object.keys,Object),oa=ra,aa=Ro,ia=oa,sa=Object.prototype,ca=sa.hasOwnProperty;function la(e){if(!aa(e))return ia(e);var t=[];for(var n in Object(e))ca.call(e,n)&&n!="constructor"&&t.push(n);return t}var da=la,pa=Zo,ua=da,ma=et;function fa(e){return ma(e)?pa(e):ua(e)}var ga=fa,ba=Xn,ha=Dr,va=ga,ya=ha(function(e,t,n,a){ba(t,va(t),e,a)}),xa=ya;const Sa=Fe(xa);function ve(...e){function t(a,i){return i===void 0?a:i}let n=Object.assign({},e[0]);for(let a=1;a<e.length;a++)n=Sa(n,e[a],t);return n}function $a(e){return T.createElement("svg",Object.assign({width:"1em",height:"1em",viewBox:"0 0 48 48",xmlns:"http://www.w3.org/2000/svg",xmlnsXlink:"http://www.w3.org/1999/xlink"},e,{style:Object.assign({verticalAlign:"-0.125em"},e.style),className:["antd-mobile-icon",e.className].filter(Boolean).join(" ")}),T.createElement("g",{id:"LeftOutline-LeftOutline",stroke:"none",strokeWidth:1,fill:"none",fillRule:"evenodd"},T.createElement("g",{id:"LeftOutline-编组"},T.createElement("rect",{id:"LeftOutline-矩形",fill:"#FFFFFF",opacity:0,x:0,y:0,width:48,height:48}),T.createElement("path",{d:"M31.7053818,5.11219264 L13.5234393,22.6612572 L13.5234393,22.6612572 C12.969699,23.2125856 12.9371261,24.0863155 13.4257204,24.6755735 L13.5234393,24.7825775 L31.7045714,42.8834676 C31.7795345,42.9580998 31.8810078,43 31.9867879,43 L35.1135102,43 C35.3344241,43 35.5135102,42.8209139 35.5135102,42.6 C35.5135102,42.4936115 35.4711279,42.391606 35.3957362,42.316542 L16.7799842,23.7816937 L16.7799842,23.7816937 L35.3764658,5.6866816 C35.5347957,5.53262122 35.5382568,5.27937888 35.3841964,5.121049 C35.3088921,5.04365775 35.205497,5 35.0975148,5 L31.9831711,5 C31.8795372,5 31.7799483,5.04022164 31.7053818,5.11219264 Z",id:"LeftOutline-路径",fill:"currentColor",fillRule:"nonzero"}))))}function Ca(e){return T.createElement("svg",Object.assign({width:"1em",height:"1em",viewBox:"0 0 48 48",xmlns:"http://www.w3.org/2000/svg",xmlnsXlink:"http://www.w3.org/1999/xlink"},e,{style:Object.assign({verticalAlign:"-0.125em"},e.style),className:["antd-mobile-icon",e.className].filter(Boolean).join(" ")}),T.createElement("g",{id:"RightOutline-RightOutline",stroke:"none",strokeWidth:1,fill:"none",fillRule:"evenodd"},T.createElement("g",{id:"RightOutline-RightOutlined"},T.createElement("rect",{id:"RightOutline-矩形",fill:"#FFFFFF",opacity:0,x:0,y:0,width:48,height:48}),T.createElement("path",{d:"M17.3947957,5.11219264 L35.5767382,22.6612572 L35.5767382,22.6612572 C36.1304785,23.2125856 36.1630514,24.0863155 35.6744571,24.6755735 L35.5767382,24.7825775 L17.3956061,42.8834676 C17.320643,42.9580998 17.2191697,43 17.1133896,43 L13.9866673,43 C13.7657534,43 13.5866673,42.8209139 13.5866673,42.6 C13.5866673,42.4936115 13.6290496,42.391606 13.7044413,42.316542 L32.3201933,23.7816937 L32.3201933,23.7816937 L13.7237117,5.6866816 C13.5653818,5.53262122 13.5619207,5.27937888 13.7159811,5.121049 C13.7912854,5.04365775 13.8946805,5 14.0026627,5 L17.1170064,5 C17.2206403,5 17.3202292,5.04022164 17.3947957,5.11219264 Z",id:"RightOutline-right",fill:"currentColor",fillRule:"nonzero"}))))}const it="adm-safe-area",Ia=e=>L(e,l.createElement("div",{className:k(it,`${it}-position-${e.position}`)})),z="adm-badge",st=l.createElement(l.Fragment,null),ct=ue(e=>{const{content:t,color:n,children:a}=e,i=t===st,c=k(z,{[`${z}-fixed`]:!!a,[`${z}-dot`]:i,[`${z}-bordered`]:e.bordered}),d=t||t===0?L(e,l.createElement("div",{className:c,style:{"--color":n}},!i&&l.createElement("div",{className:`${z}-content`},t))):null;return a?l.createElement("div",{className:k(`${z}-wrapper`,e.wrapperClassName),style:e.wrapperStyle},a,d):d},{dot:st});function wa(e){const{value:t,defaultValue:n,onChange:a}=e,i=de.useUpdate(),c=l.useRef(t!==void 0?t:n);t!==void 0&&(c.current=t);const d=de.useMemoizedFn((s,p=!1)=>{const u=typeof s=="function"?s(c.current):s;if(!(!p&&u===c.current))return c.current=u,i(),a==null?void 0:a(u)});return[c.current,d]}var lt={exports:{}},g={};/**
 * @license React
 * react-is.production.min.js
 *
 * Copyright (c) Facebook, Inc. and its affiliates.
 *
 * This source code is licensed under the MIT license found in the
 * LICENSE file in the root directory of this source tree.
 */var ye=Symbol.for("react.element"),xe=Symbol.for("react.portal"),Q=Symbol.for("react.fragment"),Y=Symbol.for("react.strict_mode"),R=Symbol.for("react.profiler"),ee=Symbol.for("react.provider"),te=Symbol.for("react.context"),Pa=Symbol.for("react.server_context"),ne=Symbol.for("react.forward_ref"),re=Symbol.for("react.suspense"),oe=Symbol.for("react.suspense_list"),ae=Symbol.for("react.memo"),ie=Symbol.for("react.lazy"),Ta=Symbol.for("react.offscreen"),dt;dt=Symbol.for("react.module.reference");function w(e){if(typeof e=="object"&&e!==null){var t=e.$$typeof;switch(t){case ye:switch(e=e.type,e){case Q:case R:case Y:case re:case oe:return e;default:switch(e=e&&e.$$typeof,e){case Pa:case te:case ne:case ie:case ae:case ee:return e;default:return t}}case xe:return t}}}g.ContextConsumer=te,g.ContextProvider=ee,g.Element=ye,g.ForwardRef=ne,g.Fragment=Q,g.Lazy=ie,g.Memo=ae,g.Portal=xe,g.Profiler=R,g.StrictMode=Y,g.Suspense=re,g.SuspenseList=oe,g.isAsyncMode=function(){return!1},g.isConcurrentMode=function(){return!1},g.isContextConsumer=function(e){return w(e)===te},g.isContextProvider=function(e){return w(e)===ee},g.isElement=function(e){return typeof e=="object"&&e!==null&&e.$$typeof===ye},g.isForwardRef=function(e){return w(e)===ne},g.isFragment=function(e){return w(e)===Q},g.isLazy=function(e){return w(e)===ie},g.isMemo=function(e){return w(e)===ae},g.isPortal=function(e){return w(e)===xe},g.isProfiler=function(e){return w(e)===R},g.isStrictMode=function(e){return w(e)===Y},g.isSuspense=function(e){return w(e)===re},g.isSuspenseList=function(e){return w(e)===oe},g.isValidElementType=function(e){return typeof e=="string"||typeof e=="function"||e===Q||e===R||e===Y||e===re||e===oe||e===Ta||typeof e=="object"&&e!==null&&(e.$$typeof===ie||e.$$typeof===ae||e.$$typeof===ee||e.$$typeof===te||e.$$typeof===ne||e.$$typeof===dt||e.getModuleId!==void 0)},g.typeOf=w,lt.exports=g;var Ma=lt.exports;function ka(e,t){let n=0;function a(i){l.Children.forEach(i,c=>{Ma.isFragment(c)?a(c.props.children):(t(c,n),n+=1)})}a(e)}const V="adm-list",Oa={mode:"default"},Ea=l.forwardRef((e,t)=>{const n=ve(Oa,e),a=l.useRef(null);return l.useImperativeHandle(t,()=>({get nativeElement(){return a.current}})),L(n,l.createElement("div",{className:k(V,`${V}-${n.mode}`),ref:a},n.header&&l.createElement("div",{className:`${V}-header`},n.header),l.createElement("div",{className:`${V}-body`},l.createElement("div",{className:`${V}-body-inner`},n.children))))});function K(e){return e!=null&&e!==!1}const O="adm-list-item",se=ue(Ea,{Item:e=>{var t;const n=(t=e.clickable)!==null&&t!==void 0?t:!!e.onClick,a=e.arrow===void 0?n:e.arrow,i=l.createElement("div",{className:`${O}-content`},K(e.prefix)&&l.createElement("div",{className:`${O}-content-prefix`},e.prefix),l.createElement("div",{className:`${O}-content-main`},K(e.title)&&l.createElement("div",{className:`${O}-title`},e.title),e.children,K(e.description)&&l.createElement("div",{className:`${O}-description`},e.description)),K(e.extra)&&l.createElement("div",{className:`${O}-content-extra`},e.extra),K(a)&&l.createElement("div",{className:`${O}-content-arrow`},a===!0?l.createElement(Ca,null):a));return L(e,l.createElement(n?"a":"div",{className:k(`${O}`,n?["adm-plain-anchor"]:[],e.disabled&&`${O}-disabled`),onClick:e.disabled?void 0:e.onClick},i))}}),G="adm-nav-bar",Ba={backArrow:!0},Na=e=>{const t=ve(Ba,e),{back:n,backArrow:a}=t;return L(t,l.createElement("div",{className:k(G)},l.createElement("div",{className:`${G}-left`,role:"button"},n!==null&&l.createElement("div",{className:`${G}-back`,onClick:t.onBack},a&&l.createElement("span",{className:`${G}-back-arrow`},a===!0?l.createElement($a,null):a),l.createElement("span",{"aria-hidden":"true"},n)),t.left),l.createElement("div",{className:`${G}-title`},t.children),l.createElement("div",{className:`${G}-right`},t.right)))},ja=()=>null,E="adm-tab-bar",Aa={safeArea:!1},Se=ue(e=>{var t;const n=ve(Aa,e);let a=null;const i=[];ka(n.children,(s,p)=>{if(!l.isValidElement(s))return;const u=s.key;typeof u=="string"&&(p===0&&(a=u),i.push(s))});const[c,d]=wa({value:n.activeKey,defaultValue:(t=n.defaultActiveKey)!==null&&t!==void 0?t:a,onChange:s=>{var p;s!==null&&((p=n.onChange)===null||p===void 0||p.call(n,s))}});return L(n,l.createElement("div",{className:E},l.createElement("div",{className:`${E}-wrap`},i.map(s=>{const p=s.key===c;function u(){const m=s.props.icon&&l.createElement("div",{className:`${E}-item-icon`},typeof s.props.icon=="function"?s.props.icon(p):s.props.icon),$=s.props.title&&l.createElement("div",{className:k(`${E}-item-title`,!!m&&`${E}-item-title-with-icon`)},typeof s.props.title=="function"?s.props.title(p):s.props.title);return m?l.createElement(l.Fragment,null,l.createElement(ct,{content:s.props.badge,className:`${E}-icon-badge`},m),$):$?l.createElement(ct,{content:s.props.badge,className:`${E}-title-badge`},$):null}return L(s.props,l.createElement("div",{key:s.key,onClick:()=>{const{key:m}=s;m!=null&&d(m.toString())},className:k(`${E}-item`,{[`${E}-item-active`]:p})},u()))})),n.safeArea&&l.createElement(Ia,{position:"bottom"})))},{Item:ja}),pt={type:"void","x-component":"MPage","x-designer":"MPage.Designer","x-component-props":{},properties:{grid:{type:"void","x-component":"Grid","x-initializer":"mobilePage:addBlock","x-component-props":{showDivider:!1}}}},Fa=e=>{const{t}=I(),n=b.useFieldSchema(),{dn:a}=o.useDesignable(),i=b.useField(),c={dn:a,field:i,fieldSchema:n};return r.jsx(o.SchemaSettingsDropdown,B(S({title:r.jsx(v.Button,{style:{borderColor:"var(--colorSettings)",color:"var(--colorSettings)"},icon:r.jsx(j.MenuOutlined,{}),type:"dashed",children:t("Menu configuration")})},c),{children:r.jsx(o.SchemaSettingsRemove,{removeParentsIfNoChildren:!0,confirm:{title:t("Delete menu block")},breakRemoveOn:{"x-component":"Grid"}},"remove")}))},W=()=>{const{dn:e}=o.useDesignable(),t=b.useFieldSchema(),n=b.useField();return{onUpdateComponentProps:de.useMemoizedFn(i=>N(this,null,function*(){q.set(t,"x-component-props",i),n.componentProps=S(S({},n.componentProps),i),yield e.emit("patch",{schema:{"x-uid":t["x-uid"],"x-component-props":t["x-component-props"],"x-server-hooks":[{type:"onSelfSave",method:"extractTextToLocale"}]}}),yield e.refresh()}))}},ut={properties:{name:{type:"string",title:A("Menu name"),required:!0,"x-component":"Input","x-decorator":"FormItem"},icon:{"x-decorator":"FormItem","x-component":"IconPicker",title:A("Icon"),"x-component-props":{}}}},_a=e=>{const{icon:t,name:n}=e,a=o.useDesigner(),i=y.useNavigate(),c=y.useLocation(),d=b.useFieldSchema(),s=o.useCompile(),p=y.useParams(),u=()=>{const m=c.pathname.endsWith("/")?c.pathname.slice(0,-1):c.pathname;i(p.name?`/mobile/${d["x-uid"]}`:`${m}/${d["x-uid"]}`)};return r.jsxs(o.SortableItem,{className:o.cx("nb-mobile-menu-item",o.css`
          width: 100%;
          background: var(--adm-color-background);
          > .adm-list-item {
            background: inherit;
          }
        `),children:[r.jsx(se.Item,B(S({arrow:!0,clickable:!0},e),{prefix:r.jsx(o.Icon,{type:t}),onClick:u,children:s(n)})),r.jsx(a,{})]})},La=()=>{const{t:e}=I(),{onUpdateComponentProps:t}=W(),n=b.useField();return r.jsxs(o.GeneralSchemaDesigner,{children:[r.jsx(o.SchemaSettingsModalItem,{title:e("Edit menu info"),initialValues:n.componentProps,schema:ut,onSubmit:t}),r.jsx(o.SchemaSettingsRemove,{removeParentsIfNoChildren:!0,confirm:{title:e("Delete menu item?")},breakRemoveOn:{"x-component":"MMenu"}},"remove")]})},mt=_a;mt.Designer=La;const Da=o.createStyles(({token:e,css:t})=>({mobileMenu:t`
      --adm-color-primary: ${e.colorPrimary};
      --adm-color-primary-hover: ${e.colorPrimaryHover};
      --adm-color-primary-active: ${e.colorPrimaryActive};
      --padding-left: ${e.paddingSM}px;
      --adm-color-background: ${e.colorBgContainer};
      --adm-color-border: ${e.colorBorder};

      background: ${e.colorBgContainer};
      width: 100%;
      margin-bottom: var(--nb-spacing);
    `})),$e=e=>{const{styles:t}=Da(),n=o.useDesigner(),a=b.useFieldSchema(),{insertBeforeEnd:i,designable:c}=o.useDesignable(),{t:d}=I(),s=p=>{const u={page:pt};return i({type:"void",title:p.name,"x-component":"MMenu.Item","x-component-props":p,"x-designer":"MMenu.Item.Designer",properties:u})};return r.jsx(o.SortableItem,{className:o.cx("nb-mobile-menu",t.mobileMenu),children:r.jsxs(se,{children:[c&&r.jsx(se.Item,{children:r.jsx(n,{})}),r.jsx(o.DndContext,{children:r.jsx(o.SchemaComponent,{onlyRenderProperties:!0,schema:a})}),c?r.jsx(se.Item,{children:r.jsx(o.SchemaInitializerActionModal,{buttonText:d("Add menu item"),title:d("Add menu item"),schema:ut,onSubmit:s})}):null]})})};$e.Item=mt,$e.Designer=Fa;const ce=(e,t)=>e.reduceProperties((a,i)=>a||i["x-component"]===t&&i),za=e=>ce(e,"Grid"),Ga=["Grid","Grid.Row"],Ua=["Grid.Col"],Ce=(e,t)=>{if(!e)return 0;let n=0;return Ua.includes(e["x-component"])&&(n+=1),typeof t=="number"&&n>=t||Ga.includes(e["x-component"])&&e.mapProperties(a=>{n+=Ce(a,t)}),n},qa=()=>{const{t:e}=I(),t=b.useFieldSchema(),{onUpdateComponentProps:n}=W(),a=b.useField(),{dn:i}=o.useDesignable(),c=y.useNavigate(),d=ce(t,"MTabBar"),s=d&&a.componentProps.tabBarEnabled!==!1,p={dn:i,field:a,fieldSchema:t};return r.jsx(o.SchemaSettingsDropdown,B(S({title:r.jsx(v.Button,{style:{borderColor:"var(--colorSettings)",color:"var(--colorSettings)",width:"100%"},icon:r.jsx(j.MenuOutlined,{}),type:"dashed",children:e("App level Configuration")})},p),{children:r.jsx(o.SchemaSettingsSwitchItem,{checked:s,title:e("Enable TabBar"),onChange:u=>N(this,null,function*(){if(u&&!d){const m=ce(t,"MPage");yield i.remove(m),yield i.insertBeforeEnd({type:"void","x-component":"MTabBar","x-component-props":{},name:"tabBar",properties:{[pe.uid()]:{type:"void","x-component":"MTabBar.Item","x-designer":"MTabBar.Item.Designer","x-component-props":{icon:"HomeOutlined",title:A("Untitled")},properties:{page:m.toJSON()}}}})}yield n({tabBarEnabled:u}),u===!1&&c("../")})})}))},Ha=o.createStyles(({token:e,css:t})=>({mobileContainer:t`
      --adm-color-primary: ${e.colorPrimary};

      & > .general-schema-designer > .general-schema-designer-icons {
        right: unset;
        left: 2px;
      }
      background: var(--nb-box-bg);
      display: flex;
      flex-direction: column;
      width: 100%;
      height: 100%;
      overflow-y: scroll;
      position: initial !important;
    `,tabBar:t`
      & > .general-schema-designer {
        --nb-designer-top: ${e.marginMD}px;
      }
      position: absolute;
      background: ${e.colorBgContainer};
      width: 100%;
      bottom: 0;
      left: 0;
      z-index: 1000;
    `})),ft=(e,t)=>e.reduceProperties((n,a)=>{if(n)return n;if(a["x-component"]==="MTabBar")return ft(a,t);if(a["x-component"]==="MTabBar.Item"&&t===a["x-uid"])return a}),Va=()=>{const{name:e}=y.useParams(),t=b.useFieldSchema();if(!e)return r.jsx(r.Fragment,{});const n=ft(t.properties.tabBar,e.replace("tab_",""));return n?r.jsx(o.SchemaComponent,{schema:n}):r.jsx(y.Navigate,{replace:!0,to:"../"})},Ie=e=>{var D,F;const{styles:t}=Ha(),{token:n}=o.useToken(),a=o.useDesigner(),i=b.useFieldSchema(),c=y.useNavigate(),d=y.useParams(),s=y.useLocation(),u=b.useField().componentProps.tabBarEnabled!==!1,m=(D=i==null?void 0:i.properties)==null?void 0:D.tabBar,$=m!=null&&m.properties?Object.keys(m.properties)[0]:null;let C=null;return $&&(C=(F=m==null?void 0:m.properties[$])==null?void 0:F["x-uid"]),l.useEffect(()=>{if(C&&!d.name){const P=s.pathname.endsWith("/")?s.pathname.slice(0,-1):s.pathname;c(`${P}/tab_${C}`,{replace:!0})}},[s.pathname,c,d.name,C]),r.jsxs(o.SortableItem,{eid:"nb-mobile-scroll-wrapper",className:o.cx("nb-mobile-container",t.mobileContainer),children:[r.jsx(a,{}),r.jsx("div",{style:{paddingBottom:C?n.paddingLG*2:0},className:"nb-mobile-container-content",children:C?r.jsx(Va,{}):r.jsx(o.SchemaComponent,{filterProperties:P=>P["x-component"]!=="MTabBar",schema:i})}),u&&r.jsx("div",{className:o.cx("nb-mobile-container-tab-bar",t.tabBar),children:r.jsx(o.SchemaComponent,{onlyRenderProperties:!0,filterProperties:P=>P["x-component"]==="MTabBar",schema:i})})]})};Ie.Designer=qa,Ie.displayName="MContainer";const gt={properties:{title:{type:"string",title:"{{ t('Title') }}",required:!0,"x-component":"Input","x-decorator":"FormItem"},icon:{required:!0,"x-decorator":"FormItem","x-component":"IconPicker",title:"{{ t('Icon') }}","x-component-props":{}}}},Ka=()=>{const e=o.useDesigner();return r.jsx(o.SortableItem,{className:o.cx("nb-mobile-tab-bar-item",o.css`
          position: absolute !important;
          width: 100%;
          height: 100%;
          top: 0;
          left: 0;
        `),children:r.jsx(e,{})})},Wa=()=>{const{t:e}=I(),t=b.useFieldSchema(),{onUpdateComponentProps:n}=W(),a=b.useField(),i=Object.keys(t.parent.properties).length;return r.jsxs(o.GeneralSchemaDesigner,{children:[r.jsx(o.SchemaSettingsModalItem,{title:e("Edit info"),initialValues:a.componentProps,schema:gt,onSubmit:n}),i>1?r.jsx(o.SchemaSettingsRemove,{removeParentsIfNoChildren:!0,confirm:{title:e("Delete tab item?")},breakRemoveOn:{"x-component":"MTabBar"}},"remove"):null]})},bt=Ka;bt.Designer=Wa;const we=e=>{const t=b.useFieldSchema(),{designable:n}=o.useDesignable(),{t:a}=I(),{insertBeforeEnd:i}=o.useDesignable(),c=y.useNavigate(),d=y.useParams(),s=o.useCompile(),p=l.useCallback(u=>i({type:"void","x-component":"MTabBar.Item","x-component-props":u,"x-designer":"MTabBar.Item.Designer",properties:{[pe.uid()]:pt},"x-server-hooks":[{type:"onSelfSave",method:"extractTextToLocale"}]}),[]);return r.jsx(o.SortableItem,{className:o.cx("nb-mobile-tab-bar",o.css`
          position: relative;
          width: 100%;
          display: flex;
          align-items: center;
        `),children:r.jsx(o.DndContext,{children:r.jsxs(Se,{activeKey:d.name,onChange:u=>{u!=="add-tab"&&c(`/mobile/${u}`)},safeArea:!0,className:o.cx(o.css`
            width: 100%;
          `),children:[t.mapProperties((u,m)=>{const $=u["x-component-props"];return l.createElement(Se.Item,B(S({},$),{key:`tab_${u["x-uid"]}`,title:r.jsxs(r.Fragment,{children:[a(s($.title)),r.jsx(o.SchemaComponent,{schema:u,name:m})]}),icon:$.icon?r.jsx(o.Icon,{type:$.icon}):void 0}))}),n&&(!t.properties||Object.keys(t.properties).length<5)?r.jsx(Se.Item,{className:o.css`
                .adm-tab-bar-item-icon {
                  height: auto;
                }
              `,icon:r.jsx(o.SchemaInitializerActionModal,{title:a("Add tab"),onSubmit:p,schema:gt})},"add-tab"):null]})})})};we.Item=bt,we.displayName="MTabBar";const Ja=e=>{var C,D,F,P;const{showBack:t}=e,{t:n}=I(),a=b.useField(),i=b.useFieldSchema(),{dn:c}=o.useDesignable(),{onUpdateComponentProps:d}=W(),s=(C=i==null?void 0:i.properties)==null?void 0:C.header,p=!!s&&((D=a.componentProps)==null?void 0:D.headerEnabled)!==!1,u=(F=i==null?void 0:i.properties)==null?void 0:F.tabs,m=!!u&&((P=a.componentProps)==null?void 0:P.tabsEnabled)!==!1,$={dn:c,field:a,fieldSchema:i};return r.jsxs(o.SchemaSettingsDropdown,B(S({title:r.jsx(v.Button,{style:{borderColor:"var(--colorSettings)",color:"var(--colorSettings)",width:"100%"},icon:r.jsx(j.MenuOutlined,{}),type:"dashed",children:n("Page configuration")})},$),{children:[r.jsx(o.SchemaSettingsSwitchItem,{checked:p,title:n("Enable Header"),onChange:U=>N(this,null,function*(){var _;s||(yield c.insertAfterBegin({type:"void",name:"header","x-component":"MHeader","x-designer":"MHeader.Designer","x-component-props":{title:(_=i.parent["x-component-props"])==null?void 0:_.name,showBack:t}})),yield d({headerEnabled:U})})}),r.jsx(o.SchemaSettingsSwitchItem,{checked:m,title:n("Enable Tabs"),onChange:U=>N(this,null,function*(){if(!u){const _=za(i);return yield c.remove(_),c.insertBeforeEnd({type:"void",name:"tabs","x-component":"Tabs","x-component-props":{},"x-initializer":"popup:addTab","x-initializer-props":{gridInitializer:"mobilePage:addBlock"},properties:{tab1:{type:"void",title:A("Untitled"),"x-component":"Tabs.TabPane","x-designer":"Tabs.Designer","x-component-props":{},properties:{grid:B(S({},_),{"x-uid":pe.uid()})}}}})}yield d({tabsEnabled:U})})})]}))},Xa=o.createStyles(({token:e,css:t})=>({globalActionCSS:t`
      #nb-position-container > & {
        height: ${e.sizeXXL}px;
        border-top: 1px solid var(--nb-box-bg);
        margin-bottom: 0px !important;
        padding: 0 var(--nb-spacing);
        align-items: center;
        overflow-x: auto;
        background: ${e.colorBgContainer};
        z-index: 100;
      }
    `,mobilePage:t`
      background: var(--nb-box-bg);
      display: flex;
      flex-direction: column;
      width: 100%;
      height: 100%;
      overflow-x: hidden;
      overflow-y: auto;
      padding-bottom: var(--nb-spacing);
    `,mobilePageHeader:t`
      & > .ant-tabs > .ant-tabs-nav {
        .ant-tabs-tab {
          margin: 0 !important;
          padding: 0 ${e.paddingContentHorizontal}px !important;
        }
        background: ${e.colorBgContainer};
      }
      display: flex;
      flex-direction: column;
    `})),Pe=e=>{var P,U,_,It;const{styles:t}=Xa(),n=o.useDesigner(),a=b.useField(),i=b.useFieldSchema(),[c,d]=y.useSearchParams(),s=(P=i.properties)==null?void 0:P.tabs,p=a.componentProps.headerEnabled!==!1,u=a.componentProps.tabsEnabled!==!1&&s;let m=ce(i,"MPage");if(!u&&!m&&s){const x=Object.values(s.properties||{}).sort((Me,ke)=>Me["x-index"]-ke["x-index"]);x.length!==0&&(m=x[0])}const $=i.root===i.parent;let C=!1;if(!s&&i.properties)C=Ce(i.properties.grid,2)===1;else if(c.has("tab")&&((U=s==null?void 0:s.properties)!=null&&U[c.get("tab")]))C=Ce((It=(_=s.properties[c.get("tab")])==null?void 0:_.properties)==null?void 0:It.grid,2)===1;else if(s!=null&&s.properties){const x=Object.values(s.properties).sort((Me,ke)=>Me["x-index"]-ke["x-index"])[0];x&&setTimeout(()=>{d([["tab",x.name.toString()]],{replace:!0})})}const D=l.useCallback(x=>{d([["tab",x]],{replace:!0})},[d]),F=l.useCallback(x=>r.jsx(o.TabsContextProvider,{children:C?r.jsx(o.ActionBarProvider,{container:(typeof x.active=="undefined"||x.active)&&$?document.getElementById("nb-position-container"):null,forceProps:{layout:"one-column",className:t.globalActionCSS},children:x.children}):x.children}),[C,$,t.globalActionCSS]);return r.jsxs(o.SortableItem,{eid:"nb-mobile-scroll-wrapper",className:o.cx("nb-mobile-page",t.mobilePage),children:[r.jsx(n,S({},i==null?void 0:i["x-designer-props"])),r.jsxs("div",{style:{paddingBottom:s?null:"var(--nb-spacing)"},className:o.cx("nb-mobile-page-header",t.mobilePageHeader,{[o.css`
            & > .ant-nb-grid {
              margin-top: 14px;
            }
          `]:s&&!u||!s}),children:[p&&r.jsx(b.RecursionField,{schema:i,filterProperties:x=>x["x-component"]==="MHeader"}),r.jsx(o.TabsContextProvider,{PaneRoot:F,activeKey:c.get("tab"),onChange:D,children:r.jsx(b.RecursionField,{schema:u?i:m,filterProperties:x=>x["x-component"]==="Tabs"||x["x-component"]==="Grid"||x["x-component"]==="Grid.Row"})})]}),r.jsx(F,{children:!s&&r.jsx(b.RecursionField,{schema:i,filterProperties:x=>x["x-component"]!=="MHeader"})})]})};Pe.Designer=Ja,Pe.displayName="MPage";const Za=()=>{const e=b.useField(),{onUpdateComponentProps:t}=W(),{t:n}=I();return r.jsx(o.GeneralSchemaDesigner,{draggable:!1,children:r.jsx(o.SchemaSettingsModalItem,{title:n("Edit info"),components:{Switch:Tt.Switch},initialValues:e.componentProps,schema:{properties:{title:{type:"string",title:n("Title"),required:!0,"x-component":"Input","x-decorator":"FormItem"},showBack:{type:"boolean",title:n("Display back button"),"x-component":"Switch","x-decorator":"FormItem"}}},onSubmit:t})})},ht=e=>{const t=b.useField(),{title:n=A("Untitled"),showBack:a=!1}=S(S({},e),t==null?void 0:t.componentProps),i=o.useDesigner(),d=o.useCompile()(n),s=y.useNavigate(),{setTitle:p}=o.useDocumentTitle(),{token:u}=o.useToken();l.useEffect(()=>{p(d)},[d]);const m=l.useMemo(()=>({width:"100%",background:u.colorBgContainer}),[u.colorBgContainer]);return r.jsxs(o.SortableItem,{className:o.cx("nb-mobile-header"),style:m,children:[r.jsx(Na,{backArrow:a,onBack:()=>s(-1),children:d}),r.jsx(i,{})]})};ht.Designer=Za;const Qa=()=>{const{t:e}=I();return r.jsx(o.GeneralSchemaDesigner,{children:r.jsx(o.SchemaSettingsRemove,{removeParentsIfNoChildren:!0,confirm:{title:e("Delete settings block")},breakRemoveOn:{"x-component":"Grid"}},"remove")})},vt=()=>{const e=o.useDesigner();return r.jsxs(o.SortableItem,{className:o.cx("nb-mobile-setting",o.css`
          margin-bottom: var(--nb-spacing);
        `),children:[r.jsx(e,{}),r.jsx(o.SettingsMenu,{redirectUrl:"/mobile"})]})};vt.Designer=Qa;const Ya=()=>{const e=o.useSchemaInitializerItem(),{insert:t}=o.useSchemaInitializer();return r.jsx(o.SchemaInitializerItem,S({icon:r.jsx(j.SettingOutlined,{}),onClick:()=>N(this,null,function*(){t({type:"void","x-component":"MSettings","x-designer":"MSettings.Designer","x-component-props":{}})})},e))},yt=l.createContext(null),Ra=e=>r.jsx(yt.Provider,{value:{interface:!0},children:e.children}),xt=()=>l.useContext(yt),ei=o.css`
  padding: 0 var(--nb-spacing);
  & > .nb-action-bar {
    padding: unset !important;
    background: unset !important;
  }
`,ti=()=>({className:ei}),ni={xs:1,sm:1,md:1,lg:1,xl:1,xxl:1},ri=()=>({columnCount:xt()?ni:null,pagination:{simple:!0}}),oi=e=>r.jsx(o.SchemaComponentOptions,{components:{MMenuBlockInitializer:Bt,MSettingsBlockInitializer:Ya,MContainer:Ie,MMenu:$e,MTabBar:we,MPage:Pe,MHeader:ht,MSettings:vt},scope:{useGridCardBlockItemProps:ti,useGridCardBlockProps:ri},children:e.children}),ai=()=>{const{t:e}=I(),t=o.useApp(),n=()=>{window.open(t.getRouteUrl("/mobile"))};return r.jsx("div",{className:o.css`
        position: absolute;
        top: -40px;
        right: 0;
      `,children:r.jsx(v.Button,{type:"dashed",onClick:n,icon:r.jsx(j.LinkOutlined,{}),children:e("Preview")})})},ii=o.css`
  --nb-spacing: 14px;
`,si=o.css``,ci=o.css`
  --nb-designer-top: 2px;
  --nb-designer-right: 2px;
  .nb-sortable-designer:hover {
    position: relative;
    > .general-schema-designer {
      display: block;
    }
  }
  .general-schema-designer {
    position: absolute;
    z-index: 999;
    top: 0;
    bottom: 0;
    left: 0;
    right: 0;
    display: none;
    border: 0;
    pointer-events: none;
    > .general-schema-designer-icons {
      position: absolute;
      top: var(--nb-designer-top);
      right: var(--nb-designer-right);
      line-height: 16px;
      pointer-events: all;
      .ant-space-item {
        background-color: var(--colorSettings);
        color: #fff;
        line-height: 16px;
        width: 16px;
        padding-left: 1px;
        align-self: stretch;
      }
    }
  }
`,St={getContainer:".nb-mobile-application",width:"90%",style:{position:"absolute"}},li=B(S({},St),{style:{maxWidth:"calc(100% - 16px)"},maskStyle:{position:"absolute"},wrapClassName:o.css`
    position: absolute !important;
  `}),di=()=>"xwork-mobile-container",$t=e=>{const t=di(),n=y.useParams(),a=xt(),i=l.useMemo(()=>a?l.Fragment:o.AdminProvider,[a]);return o.useViewport(),r.jsx(i,{children:r.jsxs(oi,{children:[r.jsx(ai,{}),r.jsx(o.ActionContextProvider,{modalProps:li,drawerProps:St,children:r.jsxs("div",{className:o.cx("nb-mobile-application",ci,ii,si,o.css`
                display: flex;
                flex-direction: column;
                width: 100%;
                height: 100%;
                position: relative;
                overflow: hidden;
              `),children:[n.name&&!n.name.startsWith("tab_")?r.jsx(y.Outlet,{}):r.jsx(o.RemoteSchemaComponent,{uid:t,children:e.children},t),r.jsx("div",{id:"nb-position-container"})]})})]})})},pi=()=>{const e=o.useApp(),{t}=I(),n=l.useMemo(()=>e.getRouteUrl("/mobile"),[e]);return r.jsx(v.Card,{style:{minHeight:"600px"},children:r.jsx(v.Form,{layout:"vertical",children:r.jsx(v.Form.Item,{tooltip:`${t("The full address is")} ${window.origin}${n}`,label:t("Mobile client access address"),children:r.jsx(v.Input,{value:n,disabled:!0})})})})},ui=()=>{const{t:e}=I(),t=y.useLocation();l.useMemo(()=>{let p="/mobile";return t.pathname.startsWith("/apps")&&(p=t.pathname.split("/").slice(0,3).join("/")),p},[t.pathname]);const n=o.useAPIClient(),[a]=v.Form.useForm();let i="";(()=>{var p,u;(u=(p=n.resource("applinks")).get)==null||u.call(p,{filter:{code:"jeff_app"}}).then(({data:m})=>{console.log(m),i=m?m.data.link:"",a.setFieldsValue({jeff_app:i})})})();const d=p=>N(this,null,function*(){console.log("Success:",p.jeff_app);let m={link:p.jeff_app};yield n.resource("applinks").update({filter:{code:"jeff_app"},values:S({},m)})}),s=p=>{console.log("Failed:",p)};return r.jsx(v.Card,{style:{minHeight:"600px"},children:r.jsxs(v.Form,{layout:"vertical",form:a,onFinish:d,onFinishFailed:s,autoComplete:"off",children:[r.jsx(v.Form.Item,{tooltip:`${e("The full address is")} ${window.origin}${i}`,label:e("Jeff Mobile client access address"),name:"jeff_app",children:r.jsx(v.Input,{})}),r.jsx(v.Form.Item,{wrapperCol:{offset:23,span:16},children:r.jsx(v.Button,{type:"primary",htmlType:"submit",children:"Submit"})})]})})},Ct=l.memo(()=>{const t=o.usePlugin(Te).getMobileRouterComponent();return r.jsx(Ra,{children:r.jsx("div",{className:o.css`
          display: flex;
          width: 100%;
          height: 100%;
          position: relative;
        `,children:r.jsx(t,{})})})});Ct.displayName="InterfaceRouter";const mi=e=>r.jsx("div",{className:o.cx("nb-mobile-device-ios6",o.css(`
          display: flex;
          width: 375px;
          height: 667px;
      `),e.className),children:e.children}),fi=e=>r.jsx("div",{className:o.cx("nb-mobile-device-wrapper",o.css`
          width: 100%;
          height: 100%;
          display: flex;
          justify-content: center;
          align-items: center;
          margin-top: 50px;
        `),children:r.jsx(mi,S({className:o.css`
          box-shadow: 0 0 15px rgba(0, 0, 0, 0.3);
        `},e))}),gi=()=>r.jsx(fi,{children:r.jsx(Ct,{})});class Te extends o.Plugin{constructor(){super(...arguments);Pt(this,"mobileRouter")}load(){return N(this,null,function*(){this.setMobileRouter(),this.addRoutes(),this.addSettings(),this.app.use(Ne),this.app.schemaInitializerManager.add(Ae),this.app.schemaInitializerManager.add(Et)})}addSettings(){this.app.pluginSettingsManager.add(M,{title:`{{t("Mobile Client-side", { ns: "${M}" })}}`,icon:"MobileOutlined",Component:()=>r.jsx(y.Outlet,{})}),this.app.pluginSettingsManager.add(`${M}.interface`,{title:`{{t("Interface Configuration", { ns: "${M}" })}}`,Component:gi,sort:1}),this.app.pluginSettingsManager.add(`${M}.app`,{title:`{{t("App Configuration", { ns: "${M}" })}}`,Component:pi,sort:2}),this.app.pluginSettingsManager.add(`${M}.iframe`,{title:`{{t("App Iframe Links", { ns: "${M}" })}}`,Component:ui,sort:3})}setMobileRouter(){const n=o.createRouterManager({type:"hash"},this.app);n.add("root",{path:"/",element:r.jsx(y.Navigate,{replace:!0,to:"/mobile"})}),n.add("mobile",{path:"/mobile",element:r.jsx($t,{})}),n.add("mobile.page",{path:"/mobile/:name",element:r.jsx(o.RouteSchemaComponent,{})}),this.mobileRouter=n}getMobileRouterComponent(){return this.mobileRouter.getRouterComponent()}addRoutes(){this.app.router.add("mobile",{path:"/mobile",element:r.jsx($t,{})}),this.app.router.add("mobile.page",{path:"/mobile/:name",Component:"RouteSchemaComponent"})}}f.PluginMobileClient=Te,f.default=Te,Object.defineProperties(f,{__esModule:{value:!0},[Symbol.toStringTag]:{value:"Module"}})});
